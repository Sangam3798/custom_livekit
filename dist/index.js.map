{"version":3,"file":"index.js","sources":["../src/components/ControlButton.tsx","../src/components/AudioSelectButton.tsx","../src/components/VideoSelectButton.tsx","../src/components/ControlsView.tsx","../src/components/DisplayContext.tsx","../src/components/ParticipantView.tsx","../src/components/ScreenShareView.tsx","../src/components/desktop/GridStage.tsx","../src/components/StageUtils.ts","../src/components/desktop/SpeakerStage.tsx","../src/components/mobile/MobileStage.tsx","../src/components/StageView.tsx","../src/LiveKitRoom.tsx"],"sourcesContent":["import { faChevronDown, IconDefinition } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport React, { ReactElement, useState } from 'react';\nimport { Popover } from 'react-tiny-popover';\nimport styles from './styles.module.css';\n\nexport interface MenuItem {\n  label: string;\n}\ninterface ButtonProps {\n  label: string;\n  disabled?: boolean;\n  onClick?: () => void;\n  icon?: IconDefinition;\n  className?: string;\n  popoverContainerClassName?: string;\n  popoverTriggerBtnClassName?: string;\n  popoverTriggerBtnSeparatorClassName?: string;\n  menuItems?: MenuItem[];\n  onMenuItemClick?: (item: MenuItem) => void;\n}\n\nexport const ControlButton = ({\n  label,\n  disabled,\n  onClick,\n  icon,\n  className,\n  menuItems,\n  popoverContainerClassName,\n  popoverTriggerBtnClassName,\n  popoverTriggerBtnSeparatorClassName,\n  onMenuItemClick,\n}: ButtonProps) => {\n  const [menuVisible, setMenuVisible] = useState(false);\n\n  let classes = styles.button;\n  if (className) {\n    classes += ` ${className}`;\n  }\n\n  const handleMenuClick = (item: MenuItem) => {\n    setMenuVisible(false);\n    if (onMenuItemClick) {\n      onMenuItemClick(item);\n    }\n  };\n\n  let menuTrigger: ReactElement | undefined;\n  let menu: ReactElement = <div />;\n  if (menuItems && menuItems.length > 0) {\n    classes += ` ${styles.hasDropdown}`;\n    menuTrigger = (\n      <button\n        disabled={disabled}\n        className={`${styles.button} ${popoverTriggerBtnClassName}  ${styles.dropdown}`}\n        onClick={() => setMenuVisible(!menuVisible)}\n      >\n        <div className={`${styles.separator} ${popoverTriggerBtnSeparatorClassName}`} />\n        <FontAwesomeIcon height={32} icon={faChevronDown} />\n      </button>\n    );\n\n    menu = (\n      <div className={`${styles.popoverMenu} ${popoverContainerClassName}`}>\n        <ul className={styles.list}>\n          {menuItems?.map((item, i) => {\n            return (\n              <li key={i} onClick={() => handleMenuClick(item)}>\n                {item.label}\n              </li>\n            );\n          })}\n        </ul>\n      </div>\n    );\n  }\n\n  const mainContent = (\n    <button\n      disabled={disabled}\n      className={classes}\n      onClick={() => {\n        setMenuVisible(false);\n        if (onClick) onClick();\n      }}\n    >\n      {icon && <FontAwesomeIcon className={styles.icon} height={32} icon={icon} />}\n      {label}\n    </button>\n  );\n\n  if (!menuTrigger) {\n    return mainContent;\n  }\n\n  return (\n    <Popover isOpen={menuVisible} positions={['top']} content={menu}>\n      <div className={styles.buttonWrapper}>\n        {mainContent}\n        {menuTrigger}\n      </div>\n    </Popover>\n  );\n};\n","import { faMicrophone, faMicrophoneSlash } from '@fortawesome/free-solid-svg-icons';\nimport { Room } from 'livekit-client';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { ControlButton, MenuItem } from './ControlButton';\n\nexport interface AudioSelectButtonProps {\n  isMuted: boolean;\n  onClick?: () => void;\n  onSourceSelected?: (device: MediaDeviceInfo) => void;\n  isButtonDisabled?: boolean;\n  muteText?: string;\n  unmuteText?: string;\n  className?: string;\n  requestPermissions?: boolean;\n  popoverContainerClassName?: string;\n  popoverTriggerBtnClassName?: string;\n  popoverTriggerBtnSeparatorClassName?: string;\n}\n\nexport const AudioSelectButton = ({\n  isMuted,\n  onClick,\n  onSourceSelected,\n  isButtonDisabled,\n  muteText = 'Mute',\n  unmuteText = 'Unmute',\n  requestPermissions = true,\n  className,\n  popoverContainerClassName,\n  popoverTriggerBtnClassName,\n  popoverTriggerBtnSeparatorClassName,\n}: AudioSelectButtonProps) => {\n  const [sources, setSources] = useState<MediaDeviceInfo[]>([]);\n  const [menuItems, setMenuItems] = useState<MenuItem[]>([]);\n\n  const listAudioDevices = useCallback(async () => {\n    const devices = await Room.getLocalDevices('audioinput', requestPermissions);\n    setSources(devices);\n    setMenuItems(\n      devices.map((item) => {\n        return { label: item.label };\n      }),\n    );\n  }, []);\n\n  useEffect(() => {\n    listAudioDevices();\n    navigator.mediaDevices.addEventListener('devicechange', listAudioDevices);\n\n    return () => {\n      navigator.mediaDevices.removeEventListener('devicechange', listAudioDevices);\n    };\n  }, []);\n\n  const handleMenuItem = (item: MenuItem) => {\n    const device = sources.find((d) => d.label === item.label);\n    if (device && onSourceSelected) {\n      onSourceSelected(device);\n    }\n  };\n\n  return (\n    <ControlButton\n      label={isMuted ? unmuteText : muteText}\n      icon={isMuted ? faMicrophoneSlash : faMicrophone}\n      disabled={isButtonDisabled}\n      onClick={onClick}\n      menuItems={menuItems}\n      onMenuItemClick={handleMenuItem}\n      className={className}\n      popoverContainerClassName={popoverContainerClassName}\n      popoverTriggerBtnClassName={popoverTriggerBtnClassName}\n      popoverTriggerBtnSeparatorClassName={popoverTriggerBtnSeparatorClassName}\n    />\n  );\n};\n","import { faVideo, faVideoSlash } from '@fortawesome/free-solid-svg-icons';\nimport { Room } from 'livekit-client';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { ControlButton, MenuItem } from './ControlButton';\n\nexport interface VideoSelectButtonProps {\n  isEnabled: boolean;\n  onClick?: () => void;\n  onSourceSelected?: (device: MediaDeviceInfo) => void;\n  disableText?: string;\n  enableText?: string;\n  requestPermissions?: boolean;\n  className?: string;\n  isButtonDisabled?: boolean;\n  popoverContainerClassName?: string;\n  popoverTriggerBtnClassName?: string;\n  popoverTriggerBtnSeparatorClassName?: string;\n}\n\nexport const VideoSelectButton = ({\n  isEnabled,\n  onClick,\n  onSourceSelected,\n  disableText = 'Disable Video',\n  enableText = 'Enable Video',\n  requestPermissions = true,\n  className,\n  isButtonDisabled,\n  popoverContainerClassName,\n  popoverTriggerBtnClassName,\n  popoverTriggerBtnSeparatorClassName,\n}: VideoSelectButtonProps) => {\n  const [sources, setSources] = useState<MediaDeviceInfo[]>([]);\n  const [menuItems, setMenuItems] = useState<MenuItem[]>([]);\n\n  const listVideoDevices = useCallback(async () => {\n    const devices = await Room.getLocalDevices('videoinput', requestPermissions);\n    setSources(devices);\n    setMenuItems(\n      devices.map((item) => {\n        return { label: item.label };\n      }),\n    );\n  }, []);\n\n  useEffect(() => {\n    listVideoDevices();\n    navigator.mediaDevices.addEventListener('devicechange', listVideoDevices);\n    return () => {\n      navigator.mediaDevices.removeEventListener('devicechange', listVideoDevices);\n    };\n  }, []);\n\n  const handleMenuItem = (item: MenuItem) => {\n    const device = sources.find((d) => d.label === item.label);\n    if (device && onSourceSelected) {\n      onSourceSelected(device);\n    }\n  };\n\n  return (\n    <ControlButton\n      label={isEnabled ? disableText : enableText}\n      icon={isEnabled ? faVideo : faVideoSlash}\n      disabled={isButtonDisabled}\n      onClick={onClick}\n      menuItems={menuItems}\n      onMenuItemClick={handleMenuItem}\n      className={className}\n      popoverContainerClassName={popoverContainerClassName}\n      popoverTriggerBtnClassName={popoverTriggerBtnClassName}\n      popoverTriggerBtnSeparatorClassName={popoverTriggerBtnSeparatorClassName}\n    />\n  );\n};\n","import { faDesktop, faStop } from '@fortawesome/free-solid-svg-icons';\nimport { Room } from 'livekit-client';\nimport React, { ReactElement } from 'react';\nimport { useParticipant } from '@livekit/react-core';\nimport { AudioSelectButton } from './AudioSelectButton';\nimport { ControlButton } from './ControlButton';\nimport styles from './styles.module.css';\nimport { VideoSelectButton } from './VideoSelectButton';\n\nexport interface ControlsProps {\n  room: Room;\n  enableScreenShare?: boolean;\n  enableAudio?: boolean;\n  enableVideo?: boolean;\n  onLeave?: (room: Room) => void;\n}\n\nexport const ControlsView = ({\n  room,\n  enableScreenShare,\n  enableAudio,\n  enableVideo,\n  onLeave,\n}: ControlsProps) => {\n  const { cameraPublication: camPub, microphonePublication: micPub } = useParticipant(\n    room.localParticipant,\n  );\n\n  if (enableScreenShare === undefined) {\n    enableScreenShare = true;\n  }\n  if (enableVideo === undefined) {\n    enableVideo = true;\n  }\n  if (enableAudio === undefined) {\n    enableAudio = true;\n  }\n\n  const [audioButtonDisabled, setAudioButtonDisabled] = React.useState(false);\n  let muteButton: ReactElement | undefined;\n  if (enableAudio) {\n    const enabled = !(micPub?.isMuted ?? true);\n    muteButton = (\n      <AudioSelectButton\n        isMuted={!enabled}\n        isButtonDisabled={audioButtonDisabled}\n        onClick={async () => {\n          setAudioButtonDisabled(true);\n          room.localParticipant\n            .setMicrophoneEnabled(!enabled)\n            .finally(() => setAudioButtonDisabled(false));\n        }}\n        onSourceSelected={(device) => {\n          setAudioButtonDisabled(true);\n          room\n            .switchActiveDevice('audioinput', device.deviceId)\n            .finally(() => setAudioButtonDisabled(false));\n        }}\n      />\n    );\n  }\n\n  const [videoButtonDisabled, setVideoButtonDisabled] = React.useState(false);\n\n  let videoButton: ReactElement | undefined;\n  if (enableVideo) {\n    const enabled = !(camPub?.isMuted ?? true);\n    videoButton = (\n      <VideoSelectButton\n        isEnabled={enabled}\n        isButtonDisabled={videoButtonDisabled}\n        onClick={() => {\n          setVideoButtonDisabled(true);\n          room.localParticipant\n            .setCameraEnabled(!enabled)\n            .finally(() => setVideoButtonDisabled(false));\n        }}\n        onSourceSelected={(device) => {\n          setVideoButtonDisabled(true);\n          room\n            .switchActiveDevice('videoinput', device.deviceId)\n            .finally(() => setVideoButtonDisabled(false));\n        }}\n      />\n    );\n  }\n\n  const [screenButtonDisabled, setScreenButtonDisabled] = React.useState(false);\n  let screenButton: ReactElement | undefined;\n  if (enableScreenShare) {\n    const enabled = room.localParticipant.isScreenShareEnabled;\n    screenButton = (\n      <ControlButton\n        label={enabled ? 'Stop sharing' : 'Share screen'}\n        icon={enabled ? faStop : faDesktop}\n        disabled={screenButtonDisabled}\n        onClick={() => {\n          setScreenButtonDisabled(true);\n          room.localParticipant\n            .setScreenShareEnabled(!enabled)\n            .finally(() => setScreenButtonDisabled(false));\n        }}\n      />\n    );\n  }\n\n  return (\n    <div className={styles.controlsWrapper}>\n      {muteButton}\n      {videoButton}\n      {screenButton}\n      {onLeave && (\n        <ControlButton\n          label=\"End\"\n          className={styles.dangerButton}\n          onClick={() => {\n            room.disconnect();\n            onLeave(room);\n          }}\n        />\n      )}\n    </div>\n  );\n};\n","import React from 'react';\n\nexport interface DisplayOptions {\n  stageLayout?: string;\n  /** display debugging stats */\n  showStats?: boolean;\n}\n\nexport const DisplayContext = React.createContext<DisplayOptions>({\n  stageLayout: 'grid',\n  showStats: false,\n});\n","import React, {\n  CSSProperties,\n  ReactElement,\n  useCallback,\n  useContext,\n  useEffect,\n  useState,\n} from \"react\";\nimport {\n  faMicrophone,\n  faMicrophoneSlash,\n} from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { Property } from \"csstype\";\nimport {\n  ConnectionQuality,\n  LocalTrack,\n  Participant,\n  RemoteTrack,\n} from \"livekit-client\";\nimport { useParticipant, VideoRenderer } from \"@livekit/react-core\";\n\nimport { AspectRatio } from \"react-aspect-ratio\";\nimport { ReactComponent as connectionQuality1 } from \"../../static/connection-quality-1.svg\";\nimport { ReactComponent as connectionQuality2 } from \"../../static/connection-quality-2.svg\";\nimport { ReactComponent as connectionQuality3 } from \"../../static/connection-quality-3.svg\";\nimport { DisplayContext } from \"./DisplayContext\";\nimport styles from \"./styles.module.css\";\n\nexport interface ParticipantProps {\n  participant: Participant;\n  displayName?: string;\n  // width in CSS\n  width?: Property.Width;\n  // height in CSS\n  height?: Property.Height;\n  className?: string;\n  // aspect ratio width, if set, maintains aspect ratio\n  aspectWidth?: number;\n  // aspect ratio height\n  aspectHeight?: number;\n  // determine whether to contain or cover video.\n  // cover mode is used when layout orientation matches video orientation\n  orientation?: \"landscape\" | \"portrait\";\n  // true if overlay with participant info should be shown\n  showOverlay?: boolean;\n  // true if connection quality should be shown\n  showConnectionQuality?: boolean;\n  // additional classname when participant is currently speaking\n  speakerClassName?: string;\n  onMouseEnter?: () => void;\n  onMouseLeave?: () => void;\n  onClick?: () => void;\n}\n\nexport const ParticipantView = ({\n  participant,\n  width,\n  height,\n  className,\n  speakerClassName,\n  aspectWidth,\n  aspectHeight,\n  orientation,\n  displayName,\n  showOverlay,\n  showConnectionQuality,\n  onMouseEnter,\n  onMouseLeave,\n  onClick,\n}: ParticipantProps) => {\n  const { cameraPublication, isLocal, connectionQuality, isSpeaking } =\n    useParticipant(participant);\n  const [videoSize, setVideoSize] = useState<string>();\n  const [currentBitrate, setCurrentBitrate] = useState<number>();\n  const context = useContext(DisplayContext);\n\n  const handleResize = useCallback((width: number, height: number) => {\n    setVideoSize(`${width}x${height}`);\n  }, []);\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      let total = 0;\n      participant.tracks.forEach((pub) => {\n        if (\n          pub.track instanceof LocalTrack ||\n          pub.track instanceof RemoteTrack\n        ) {\n          total += pub.track.currentBitrate;\n        }\n      });\n      setCurrentBitrate(total);\n    }, 1000);\n    return () => {\n      clearInterval(interval);\n    };\n  }, []);\n\n  const containerStyles: CSSProperties = {\n    width: width,\n    height: height,\n  };\n\n  // when aspect matches, cover instead\n  let objectFit: Property.ObjectFit = \"contain\";\n  let videoOrientation: \"landscape\" | \"portrait\" | undefined;\n  if (!orientation && aspectWidth && aspectHeight) {\n    orientation = aspectWidth > aspectHeight ? \"landscape\" : \"portrait\";\n  }\n  if (cameraPublication?.dimensions) {\n    videoOrientation =\n      cameraPublication.dimensions.width > cameraPublication.dimensions.height\n        ? \"landscape\"\n        : \"portrait\";\n  }\n\n  if (videoOrientation === orientation) {\n    objectFit = \"cover\";\n  }\n\n  if (!displayName) {\n    displayName = participant.name || participant.identity;\n    if (isLocal) {\n      displayName += \" (You)\";\n    }\n  }\n\n  let mainElement: ReactElement;\n  if (\n    cameraPublication?.isSubscribed &&\n    cameraPublication?.track &&\n    !cameraPublication?.isMuted\n  ) {\n    mainElement = (\n      <VideoRenderer\n        track={cameraPublication.track}\n        isLocal={isLocal}\n        objectFit={objectFit}\n        width=\"100%\"\n        height=\"100%\"\n        className={styles.video}\n        onSizeChanged={handleResize}\n      />\n    );\n  } else {\n    mainElement = <div className={styles.placeholder} />;\n  }\n\n  const classes = [styles.participant];\n  if (className) {\n    classes.push(className);\n  }\n  if (isSpeaking) {\n    classes.push(speakerClassName ?? styles.speaker);\n  }\n  const isAudioMuted = !participant.isMicrophoneEnabled;\n\n  // gather stats\n  let statsContent: ReactElement | undefined;\n  if (context.showStats) {\n    statsContent = (\n      <div className={styles.stats}>\n        <span>{videoSize}</span>\n        {currentBitrate !== undefined && currentBitrate > 0 && (\n          <span>&nbsp;{Math.round(currentBitrate / 1024)} kbps</span>\n        )}\n      </div>\n    );\n  }\n\n  let ConnectionQualityIndicator: typeof connectionQuality1 | undefined;\n  if (showConnectionQuality) {\n    switch (connectionQuality) {\n      case ConnectionQuality.Excellent:\n        ConnectionQualityIndicator = connectionQuality3;\n        break;\n      case ConnectionQuality.Good:\n        ConnectionQualityIndicator = connectionQuality2;\n        break;\n      case ConnectionQuality.Poor:\n        ConnectionQualityIndicator = connectionQuality1;\n        break;\n    }\n  }\n\n  return (\n    <div\n      className={classes.join(\" \")}\n      style={containerStyles}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n      onClick={onClick}\n    >\n      {aspectWidth && aspectHeight && (\n        <AspectRatio ratio={aspectWidth / aspectHeight}>\n          {mainElement}\n        </AspectRatio>\n      )}\n      {(!aspectWidth || !aspectHeight) && mainElement}\n\n      {(showOverlay || context.showStats) && (\n        <div className={styles.participantBar}>\n          <div className={styles.name}>{displayName}</div>\n          <div className={styles.center}>{statsContent}</div>\n          <div>\n            {ConnectionQualityIndicator && <ConnectionQualityIndicator />}\n          </div>\n          <div>\n            <FontAwesomeIcon\n              icon={isAudioMuted ? faMicrophoneSlash : faMicrophone}\n              height={24}\n              className={isAudioMuted ? styles.iconRed : styles.iconNormal}\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n","import { Property } from 'csstype';\nimport { Track } from 'livekit-client';\nimport { VideoRenderer } from '@livekit/react-core';\n\nimport React from 'react';\nimport styles from './styles.module.css';\n\ninterface ScreenShareProps {\n  track: Track;\n  width?: Property.Width;\n  height?: Property.Height;\n}\n\nexport const ScreenShareView = ({ track, width, height }: ScreenShareProps) => {\n  return (\n    <div className={styles.screenShare}>\n      <VideoRenderer\n        track={track}\n        isLocal={false}\n        width={width}\n        height={height}\n        className={styles.video}\n      />\n    </div>\n  );\n};\n","import { Participant } from 'livekit-client';\nimport React, { useEffect, useState } from 'react';\nimport { ControlsView } from '../ControlsView';\nimport { ParticipantView } from '../ParticipantView';\nimport { StageProps } from '../StageProps';\nimport styles from './styles.module.css';\n\nexport const GridStage = ({\n  roomState,\n  participantRenderer,\n  controlRenderer,\n  onLeave,\n}: StageProps) => {\n  const { isConnecting, error, participants, room } = roomState;\n  const [visibleParticipants, setVisibleParticipants] = useState<Participant[]>([]);\n  const [showOverlay, setShowOverlay] = useState(false);\n  const [gridClass, setGridClass] = React.useState(styles.grid1x1);\n\n  // compute visible participants and sort.\n  useEffect(() => {\n    // determine grid size\n    let numVisible = 1;\n    if (participants.length === 1) {\n      setGridClass(styles.grid1x1);\n    } else if (participants.length === 2) {\n      setGridClass(styles.grid2x1);\n      numVisible = 2;\n    } else if (participants.length <= 4) {\n      setGridClass(styles.grid2x2);\n      numVisible = Math.min(participants.length, 4);\n    } else if (participants.length <= 9) {\n      setGridClass(styles.grid3x3);\n      numVisible = Math.min(participants.length, 9);\n    } else if (participants.length <= 16) {\n      setGridClass(styles.grid4x4);\n      numVisible = Math.min(participants.length, 16);\n    } else {\n      setGridClass(styles.grid5x5);\n      numVisible = Math.min(participants.length, 25);\n    }\n\n    // remove any participants that are no longer connected\n    const newParticipants: Participant[] = [];\n    visibleParticipants.forEach((p) => {\n      if (room?.participants.has(p.sid) || room?.localParticipant.sid === p.sid) {\n        newParticipants.push(p);\n      }\n    });\n\n    // ensure active speakers are all visible\n    room?.activeSpeakers?.forEach((speaker) => {\n      if (\n        newParticipants.includes(speaker) ||\n        (speaker !== room?.localParticipant && !room?.participants.has(speaker.sid))\n      ) {\n        return;\n      }\n      // find a non-active speaker and switch\n      const idx = newParticipants.findIndex((p) => !p.isSpeaking);\n      if (idx >= 0) {\n        newParticipants[idx] = speaker;\n      } else {\n        newParticipants.push(speaker);\n      }\n    });\n\n    // add other non speakers\n    for (const p of participants) {\n      if (newParticipants.length >= numVisible) {\n        break;\n      }\n      if (newParticipants.includes(p) || p.isSpeaking) {\n        continue;\n      }\n      newParticipants.push(p);\n    }\n\n    if (newParticipants.length > numVisible) {\n      newParticipants.splice(numVisible, newParticipants.length - numVisible);\n    }\n    setVisibleParticipants(newParticipants);\n  }, [participants]);\n\n  if (error) {\n    return <div>error {error.message}</div>;\n  }\n\n  if (isConnecting) {\n    return <div>connecting from deepak test 2</div>;\n  }\n  if (!room) {\n    return <div>room closed from deepak</div>;\n  }\n\n  if (participants.length === 0) {\n    return <div>no one is in the room</div>;\n  }\n\n  const ParticipantRenderer = participantRenderer ?? ParticipantView;\n  const ControlRenderer = controlRenderer ?? ControlsView;\n\n  return (\n    // global container\n    <div className={styles.container}>\n      <div className={`${styles.gridStage} ${gridClass}`}>\n        {visibleParticipants.map((participant) => {\n          return (\n            <ParticipantRenderer\n              key={participant.identity}\n              participant={participant}\n              orientation=\"landscape\"\n              width=\"100%\"\n              height=\"100%\"\n              showOverlay={showOverlay}\n              showConnectionQuality\n              onMouseEnter={() => setShowOverlay(true)}\n              onMouseLeave={() => setShowOverlay(false)}\n            />\n          );\n        })}\n      </div>\n      <div className={styles.controlsArea}>\n        <ControlRenderer room={room} onLeave={onLeave} />\n      </div>\n    </div>\n  );\n};\n","import { LocalParticipant, Participant } from 'livekit-client';\n\n/**\n * Default sort for participants, it'll order participants by:\n * 1. dominant speaker (speaker with the loudest audio level)\n * 2. local participant\n * 3. other speakers that are recently active\n * 4. participants with video on\n * 5. by joinedAt\n */\nexport function defaultSortParticipants(participants: Participant[]): Participant[] {\n  const sortedParticipants = [...participants];\n  sortedParticipants.sort((a, b) => {\n    // loudest speaker first\n    if (a.isSpeaking && b.isSpeaking) {\n      return b.audioLevel - a.audioLevel;\n    }\n\n    // speaker goes first\n    if (a.isSpeaking !== b.isSpeaking) {\n      if (a.isSpeaking) {\n        return -1;\n      } else {\n        return 1;\n      }\n    }\n\n    // last active speaker first\n    if (a.lastSpokeAt !== b.lastSpokeAt) {\n      const aLast = a.lastSpokeAt?.getTime() ?? 0;\n      const bLast = b.lastSpokeAt?.getTime() ?? 0;\n      return bLast - aLast;\n    }\n\n    // video on\n    const aVideo = a.videoTracks.size > 0;\n    const bVideo = b.videoTracks.size > 0;\n    if (aVideo !== bVideo) {\n      if (aVideo) {\n        return -1;\n      } else {\n        return 1;\n      }\n    }\n\n    // joinedAt\n    return (a.joinedAt?.getTime() ?? 0) - (b.joinedAt?.getTime() ?? 0);\n  });\n  const localParticipant = sortedParticipants.find((p) => p instanceof LocalParticipant);\n  if (localParticipant) {\n    const localIdx = sortedParticipants.indexOf(localParticipant);\n    if (localIdx >= 0) {\n      sortedParticipants.splice(localIdx, 1);\n      if (sortedParticipants.length > 0) {\n        sortedParticipants.splice(1, 0, localParticipant);\n      } else {\n        sortedParticipants.push(localParticipant);\n      }\n    }\n  }\n  return sortedParticipants;\n}\n","import { Participant, Track, VideoTrack } from 'livekit-client';\nimport React, { ReactElement, useEffect, useState } from 'react';\nimport { ControlsView } from '../ControlsView';\nimport { ParticipantView } from '../ParticipantView';\nimport { ScreenShareView } from '../ScreenShareView';\nimport { StageProps } from '../StageProps';\nimport { defaultSortParticipants } from '../StageUtils';\nimport styles from './styles.module.css';\n\nexport const SpeakerStage = ({\n  roomState,\n  participantRenderer,\n  controlRenderer,\n  onLeave,\n  sortParticipants,\n}: StageProps) => {\n  const { isConnecting, error, participants, room } = roomState;\n  const [showOverlay, setShowOverlay] = useState(false);\n  const sortFn = sortParticipants ?? defaultSortParticipants;\n  const [sortedParticipants, setSortedParticipants] = useState(sortFn(participants));\n\n  useEffect(() => {\n    setSortedParticipants(sortFn(participants));\n  }, [participants, sortFn]);\n\n  if (error) {\n    return <div>error {error.message}</div>;\n  }\n\n  if (isConnecting) {\n    return <div>connecting</div>;\n  }\n  if (!room) {\n    return <div>room closed</div>;\n  }\n\n  if (sortedParticipants.length === 0) {\n    return <div>no one is in the room</div>;\n  }\n\n  const ParticipantRenderer = participantRenderer ?? ParticipantView;\n  const ControlRenderer = controlRenderer ?? ControlsView;\n\n  // find first participant with screen shared\n  let screenTrack: VideoTrack | undefined;\n  sortedParticipants.forEach((p) => {\n    if (screenTrack) {\n      return;\n    }\n    const track = p.getTrack(Track.Source.ScreenShare);\n    if (track?.isSubscribed && track.videoTrack) {\n      screenTrack = track.videoTrack;\n    }\n  });\n\n  let otherParticipants = sortedParticipants;\n  let participantInFocus: Participant;\n  let mainView: ReactElement;\n  if (screenTrack) {\n    mainView = <ScreenShareView track={screenTrack} height=\"100%\" width=\"100%\" />;\n  } else {\n    [participantInFocus, ...otherParticipants] = sortedParticipants;\n    mainView = (\n      <ParticipantRenderer\n        key={participantInFocus.identity}\n        participant={participantInFocus}\n        width=\"100%\"\n        height=\"100%\"\n        orientation=\"landscape\"\n        showOverlay={showOverlay}\n        showConnectionQuality\n        onMouseEnter={() => setShowOverlay(true)}\n        onMouseLeave={() => setShowOverlay(false)}\n      />\n    );\n  }\n\n  return (\n    // global container\n    <div className={styles.container}>\n      <div className={styles.stage}>\n        <div className={styles.stageCenter}>{mainView}</div>\n        <div className={styles.sidebar}>\n          {otherParticipants.map((participant) => {\n            return (\n              <ParticipantRenderer\n                key={participant.identity}\n                participant={participant}\n                width=\"100%\"\n                aspectWidth={16}\n                aspectHeight={9}\n                showOverlay={showOverlay}\n                onMouseEnter={() => setShowOverlay(true)}\n                onMouseLeave={() => setShowOverlay(false)}\n              />\n            );\n          })}\n        </div>\n      </div>\n      <div className={styles.controlsArea}>\n        <ControlRenderer room={room} onLeave={onLeave} />\n      </div>\n    </div>\n  );\n};\n","import { Participant, Track, VideoTrack } from 'livekit-client';\nimport React, { ReactElement, useEffect, useState } from 'react';\nimport { ControlsView } from '../ControlsView';\nimport { ParticipantView } from '../ParticipantView';\nimport { ScreenShareView } from '../ScreenShareView';\nimport { StageProps } from '../StageProps';\nimport { defaultSortParticipants } from '../StageUtils';\nimport styles from './styles.module.css';\n\nexport const MobileStage = ({\n  roomState,\n  participantRenderer,\n  controlRenderer,\n  onLeave,\n  sortParticipants,\n}: StageProps) => {\n  const { isConnecting, error, participants, room } = roomState;\n  const [showOverlay, setShowOverlay] = useState(false);\n  const sortFn = sortParticipants ?? defaultSortParticipants;\n  const [sortedParticipants, setSortedParticipants] = useState(sortFn(participants));\n\n  useEffect(() => {\n    setSortedParticipants(sortFn(participants));\n  }, [participants, sortFn]);\n\n  if (error) {\n    return <div>error {error.message}</div>;\n  }\n\n  if (isConnecting) {\n    return <div>connecting</div>;\n  }\n  if (!room) {\n    return <div>room closed</div>;\n  }\n\n  if (sortedParticipants.length === 0) {\n    return <div>no one is in the room</div>;\n  }\n\n  const ParticipantRenderer = participantRenderer ?? ParticipantView;\n  const ControlRenderer = controlRenderer ?? ControlsView;\n\n  // find first participant with screen shared\n  let screenTrack: VideoTrack | undefined;\n  sortedParticipants.forEach((p) => {\n    if (screenTrack) {\n      return;\n    }\n    const track = p.getTrack(Track.Source.ScreenShare);\n    if (track?.isSubscribed && track.videoTrack) {\n      screenTrack = track.videoTrack;\n    }\n  });\n\n  let otherParticipants = sortedParticipants;\n  let participantInFocus: Participant;\n  let mainView: ReactElement;\n  if (screenTrack) {\n    mainView = <ScreenShareView track={screenTrack} height=\"100%\" width=\"100%\" />;\n  } else if (otherParticipants.length === 0) {\n    mainView = <div>no one is in the room</div>;\n  } else {\n    [participantInFocus, ...otherParticipants] = otherParticipants;\n    mainView = (\n      <ParticipantRenderer\n        key={participantInFocus.identity}\n        participant={participantInFocus}\n        showOverlay={showOverlay}\n        width=\"100%\"\n        height=\"100%\"\n        orientation=\"portrait\"\n        showConnectionQuality\n        onMouseEnter={() => setShowOverlay(true)}\n        onMouseLeave={() => setShowOverlay(false)}\n      />\n    );\n  }\n\n  return (\n    // global container\n    <div className={styles.container}>\n      <div className={styles.stage}>{mainView}</div>\n      <div className={styles.participantsArea}>\n        {otherParticipants.map((participant) => {\n          return (\n            <ParticipantRenderer\n              key={participant.identity}\n              participant={participant}\n              className={styles.participant}\n              aspectWidth={4}\n              aspectHeight={3}\n              showOverlay={showOverlay}\n              onMouseEnter={() => setShowOverlay(true)}\n              onMouseLeave={() => setShowOverlay(false)}\n            />\n          );\n        })}\n      </div>\n      <div className={styles.controlsArea}>\n        <ControlRenderer room={room} enableScreenShare={false} onLeave={onLeave} />\n      </div>\n    </div>\n  );\n};\n","import { faVolumeMute } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { Track, VideoTrack } from 'livekit-client';\nimport { AudioRenderer } from '@livekit/react-core';\nimport React, { ReactElement, useContext } from 'react';\nimport { useMediaQuery } from 'react-responsive';\nimport { GridStage } from './desktop/GridStage';\nimport { SpeakerStage } from './desktop/SpeakerStage';\nimport { DisplayContext } from './DisplayContext';\nimport { MobileStage } from './mobile/MobileStage';\nimport { StageProps } from './StageProps';\nimport styles from './styles.module.css';\n\nexport const StageView = (stageProps: StageProps) => {\n  const isMobile = useMediaQuery({ query: '(max-width: 800px)' });\n  const { room, participants } = stageProps.roomState;\n  const context = useContext(DisplayContext);\n\n  let mainElement: ReactElement;\n  if (isMobile) {\n    mainElement = <MobileStage {...stageProps} />;\n  } else {\n    // find first participant with screen shared\n    let screenTrack: VideoTrack | undefined;\n    participants.forEach((p) => {\n      if (screenTrack) {\n        return;\n      }\n      const track = p.getTrack(Track.Source.ScreenShare);\n      if (track?.isSubscribed && track.videoTrack) {\n        screenTrack = track.videoTrack;\n      }\n    });\n\n    if (context.stageLayout === 'grid' && screenTrack === undefined) {\n      mainElement = <GridStage {...stageProps} />;\n    } else {\n      mainElement = <SpeakerStage {...stageProps} />;\n    }\n  }\n\n  return (\n    <div className={styles.container}>\n      {mainElement}\n      {stageProps.roomState.audioTracks.map((track) => (\n        <AudioRenderer key={track.sid} track={track} isLocal={false} />\n      ))}\n\n      {room?.canPlaybackAudio === false && (\n        <div className={styles.overlay}>\n          <button\n            className={styles.unmuteButton}\n            onClick={() => {\n              room.startAudio();\n            }}\n          >\n            <FontAwesomeIcon className={styles.icon} size=\"1x\" icon={faVolumeMute} />\n            Click to Unmute\n          </button>\n        </div>\n      )}\n    </div>\n  );\n};\n","import { Room, RoomOptions, RoomConnectOptions, ConnectionState } from 'livekit-client';\nimport React, { useEffect } from 'react';\nimport { ControlsProps } from './components/ControlsView';\nimport { ParticipantProps } from './components/ParticipantView';\nimport { StageProps } from './components/StageProps';\nimport { StageView } from './components/StageView';\nimport { useRoom } from '@livekit/react-core';\n\nexport interface RoomProps {\n  url: string;\n  token: string;\n  roomOptions?: RoomOptions;\n  connectOptions?: RoomConnectOptions;\n  // when first connected to room\n  onConnected?: (room: Room) => void;\n  // when user leaves the room\n  onLeave?: (room: Room) => void;\n  stageRenderer?: (props: StageProps) => React.ReactElement | null;\n  participantRenderer?: (props: ParticipantProps) => React.ReactElement | null;\n  controlRenderer?: (props: ControlsProps) => React.ReactElement | null;\n}\n\nexport const LiveKitRoom = ({\n  url,\n  token,\n  roomOptions,\n  connectOptions,\n  stageRenderer,\n  participantRenderer,\n  controlRenderer,\n  onConnected,\n  onLeave,\n}: RoomProps) => {\n  const roomState = useRoom(roomOptions);\n\n  useEffect(() => {\n    if (roomState.room) {\n      roomState.connect(url, token, connectOptions).then((room) => {\n        if (!room) {\n          return;\n        }\n        if (onConnected && room.state === ConnectionState.Connected) {\n          onConnected(room);\n        }\n      });\n    }\n    return () => {\n      if (roomState.room?.state !== ConnectionState.Disconnected) {\n        roomState.room?.disconnect();\n      }\n    };\n  }, [roomState.room]);\n\n  const selectedStageRenderer = stageRenderer ?? StageView;\n\n  return selectedStageRenderer({\n    roomState,\n    participantRenderer,\n    controlRenderer,\n    onLeave,\n  });\n};\n"],"names":["ControlButton","_ref","label","disabled","onClick","icon","className","menuItems","popoverContainerClassName","popoverTriggerBtnClassName","popoverTriggerBtnSeparatorClassName","onMenuItemClick","_useState","useState","menuVisible","setMenuVisible","classes","styles","button","handleMenuClick","item","menuTrigger","menu","React","length","hasDropdown","dropdown","separator","FontAwesomeIcon","height","faChevronDown","popoverMenu","list","map","i","key","mainContent","Popover","isOpen","positions","content","buttonWrapper","AudioSelectButton","isMuted","onSourceSelected","isButtonDisabled","_ref$muteText","muteText","_ref$unmuteText","unmuteText","_ref$requestPermissio","requestPermissions","sources","setSources","_useState2","setMenuItems","listAudioDevices","useCallback","Room","getLocalDevices","then","devices","e","Promise","reject","useEffect","navigator","mediaDevices","addEventListener","removeEventListener","handleMenuItem","device","find","d","faMicrophoneSlash","faMicrophone","VideoSelectButton","isEnabled","_ref$disableText","disableText","_ref$enableText","enableText","listVideoDevices","faVideo","faVideoSlash","ControlsView","room","enableScreenShare","enableAudio","enableVideo","onLeave","_useParticipant","useParticipant","localParticipant","camPub","cameraPublication","micPub","microphonePublication","undefined","_React$useState","audioButtonDisabled","setAudioButtonDisabled","muteButton","_micPub$isMuted","enabled","setMicrophoneEnabled","resolve","switchActiveDevice","deviceId","_React$useState2","videoButtonDisabled","setVideoButtonDisabled","videoButton","_camPub$isMuted","setCameraEnabled","_React$useState3","screenButtonDisabled","setScreenButtonDisabled","screenButton","isScreenShareEnabled","faStop","faDesktop","setScreenShareEnabled","controlsWrapper","dangerButton","disconnect","DisplayContext","createContext","stageLayout","showStats","ParticipantView","participant","width","speakerClassName","aspectWidth","aspectHeight","orientation","displayName","showOverlay","showConnectionQuality","onMouseEnter","onMouseLeave","isLocal","connectionQuality","isSpeaking","videoSize","setVideoSize","currentBitrate","setCurrentBitrate","context","useContext","handleResize","interval","setInterval","total","tracks","forEach","pub","track","LocalTrack","RemoteTrack","clearInterval","containerStyles","objectFit","videoOrientation","dimensions","name","identity","mainElement","isSubscribed","VideoRenderer","video","onSizeChanged","placeholder","push","speaker","isAudioMuted","isMicrophoneEnabled","statsContent","stats","Math","round","ConnectionQualityIndicator","ConnectionQuality","Excellent","connectionQuality3","Good","connectionQuality2","Poor","connectionQuality1","join","style","AspectRatio","ratio","participantBar","center","iconRed","iconNormal","ScreenShareView","screenShare","GridStage","roomState","participantRenderer","controlRenderer","isConnecting","error","participants","visibleParticipants","setVisibleParticipants","setShowOverlay","grid1x1","gridClass","setGridClass","numVisible","grid2x1","grid2x2","min","grid3x3","grid4x4","grid5x5","newParticipants","p","has","sid","_room$activeSpeakers","activeSpeakers","includes","idx","findIndex","_iterator","_createForOfIteratorHelperLoose","_step","done","value","splice","message","ParticipantRenderer","ControlRenderer","container","gridStage","controlsArea","defaultSortParticipants","sortedParticipants","concat","sort","a","b","audioLevel","lastSpokeAt","_a$lastSpokeAt$getTim","_a$lastSpokeAt","_b$lastSpokeAt$getTim","_b$lastSpokeAt","aLast","getTime","bLast","aVideo","videoTracks","size","bVideo","_a$joinedAt$getTime","_a$joinedAt","joinedAt","_b$joinedAt$getTime","_b$joinedAt","LocalParticipant","localIdx","indexOf","SpeakerStage","sortParticipants","sortFn","setSortedParticipants","screenTrack","getTrack","Track","Source","ScreenShare","videoTrack","otherParticipants","participantInFocus","mainView","slice","stage","stageCenter","sidebar","MobileStage","_otherParticipants","participantsArea","StageView","stageProps","isMobile","useMediaQuery","query","_stageProps$roomState","audioTracks","AudioRenderer","canPlaybackAudio","overlay","unmuteButton","startAudio","faVolumeMute","LiveKitRoom","url","token","roomOptions","connectOptions","stageRenderer","onConnected","useRoom","connect","state","ConnectionState","Connected","_roomState$room","Disconnected","_roomState$room2","selectedStageRenderer"],"mappings":";;;;;;;;;;;;;;IAsBaA,aAAa,GAAG,SAAhBA,aAAaA,CAAAC,IAAA;MACxBC,KAAK,GAAAD,IAAA,CAALC,KAAK;IACLC,QAAQ,GAAAF,IAAA,CAARE,QAAQ;IACRC,QAAO,GAAAH,IAAA,CAAPG,OAAO;IACPC,IAAI,GAAAJ,IAAA,CAAJI,IAAI;IACJC,SAAS,GAAAL,IAAA,CAATK,SAAS;IACTC,SAAS,GAAAN,IAAA,CAATM,SAAS;IACTC,yBAAyB,GAAAP,IAAA,CAAzBO,yBAAyB;IACzBC,0BAA0B,GAAAR,IAAA,CAA1BQ,0BAA0B;IAC1BC,mCAAmC,GAAAT,IAAA,CAAnCS,mCAAmC;IACnCC,eAAe,GAAAV,IAAA,CAAfU,eAAe;EAEf,IAAAC,SAAA,GAAsCC,cAAQ,CAAC,KAAK,CAAC;IAA9CC,WAAW,GAAAF,SAAA;IAAEG,cAAc,GAAAH,SAAA;EAElC,IAAII,OAAO,GAAGC,MAAM,CAACC,MAAM;EAC3B,IAAIZ,SAAS,EAAE;IACbU,OAAO,UAAQV,SAAW;;EAG5B,IAAMa,eAAe,GAAG,SAAlBA,eAAeA,CAAIC,IAAc;IACrCL,cAAc,CAAC,KAAK,CAAC;IACrB,IAAIJ,eAAe,EAAE;MACnBA,eAAe,CAACS,IAAI,CAAC;;GAExB;EAED,IAAIC,WAAqC;EACzC,IAAIC,IAAI,GAAiBC,yCAAO;EAChC,IAAIhB,SAAS,IAAIA,SAAS,CAACiB,MAAM,GAAG,CAAC,EAAE;IACrCR,OAAO,UAAQC,MAAM,CAACQ,WAAa;IACnCJ,WAAW,GACTE;MACEpB,QAAQ,EAAEA,QAAQ;MAClBG,SAAS,EAAKW,MAAM,CAACC,MAAM,SAAIT,0BAA0B,UAAKQ,MAAM,CAACS,QAAU;MAC/EtB,OAAO,EAAE,SAAAA;QAAA,OAAMW,cAAc,CAAC,CAACD,WAAW,CAAC;;OAE3CS;MAAKjB,SAAS,EAAKW,MAAM,CAACU,SAAS,SAAIjB;MAAyC,EAChFa,6BAACK,gCAAe;MAACC,MAAM,EAAE,EAAE;MAAExB,IAAI,EAAEyB;MAAiB,CAEvD;IAEDR,IAAI,GACFC;MAAKjB,SAAS,EAAKW,MAAM,CAACc,WAAW,SAAIvB;OACvCe;MAAIjB,SAAS,EAAEW,MAAM,CAACe;OACnBzB,SAAS,aAATA,SAAS,uBAATA,SAAS,CAAE0B,GAAG,CAAC,UAACb,IAAI,EAAEc,CAAC;MACtB,OACEX;QAAIY,GAAG,EAAED,CAAC;QAAE9B,OAAO,EAAE,SAAAA;UAAA,OAAMe,eAAe,CAACC,IAAI,CAAC;;SAC7CA,IAAI,CAAClB,KAAK,CACR;KAER,CAAC,CACC,CAER;;EAGH,IAAMkC,WAAW,GACfb;IACEpB,QAAQ,EAAEA,QAAQ;IAClBG,SAAS,EAAEU,OAAO;IAClBZ,OAAO,EAAE,SAAAA;MACPW,cAAc,CAAC,KAAK,CAAC;MACrB,IAAIX,QAAO,EAAEA,QAAO,EAAE;;KAGvBC,IAAI,IAAIkB,6BAACK,gCAAe;IAACtB,SAAS,EAAEW,MAAM,CAACZ,IAAI;IAAEwB,MAAM,EAAE,EAAE;IAAExB,IAAI,EAAEA;IAAQ,EAC3EH,KAAK,CAET;EAED,IAAI,CAACmB,WAAW,EAAE;IAChB,OAAOe,WAAW;;EAGpB,OACEb,6BAACc,wBAAO;IAACC,MAAM,EAAExB,WAAW;IAAEyB,SAAS,EAAE,CAAC,KAAK,CAAC;IAAEC,OAAO,EAAElB;KACzDC;IAAKjB,SAAS,EAAEW,MAAM,CAACwB;KACpBL,WAAW,EACXf,WAAW,CACR,CACE;AAEd,CAAC;;ICrFYqB,iBAAiB,GAAG,SAApBA,iBAAiBA,CAAAzC,IAAA;MAC5B0C,OAAO,GAAA1C,IAAA,CAAP0C,OAAO;IACPvC,OAAO,GAAAH,IAAA,CAAPG,OAAO;IACPwC,gBAAgB,GAAA3C,IAAA,CAAhB2C,gBAAgB;IAChBC,gBAAgB,GAAA5C,IAAA,CAAhB4C,gBAAgB;IAAAC,aAAA,GAAA7C,IAAA,CAChB8C,QAAQ;IAARA,QAAQ,GAAAD,aAAA,cAAG,MAAM,GAAAA,aAAA;IAAAE,eAAA,GAAA/C,IAAA,CACjBgD,UAAU;IAAVA,UAAU,GAAAD,eAAA,cAAG,QAAQ,GAAAA,eAAA;IAAAE,qBAAA,GAAAjD,IAAA,CACrBkD,kBAAkB;IAAlBA,kBAAkB,GAAAD,qBAAA,cAAG,IAAI,GAAAA,qBAAA;IACzB5C,SAAS,GAAAL,IAAA,CAATK,SAAS;IACTE,yBAAyB,GAAAP,IAAA,CAAzBO,yBAAyB;IACzBC,0BAA0B,GAAAR,IAAA,CAA1BQ,0BAA0B;IAC1BC,mCAAmC,GAAAT,IAAA,CAAnCS,mCAAmC;EAEnC,IAAAE,SAAA,GAA8BC,cAAQ,CAAoB,EAAE,CAAC;IAAtDuC,OAAO,GAAAxC,SAAA;IAAEyC,UAAU,GAAAzC,SAAA;EAC1B,IAAA0C,UAAA,GAAkCzC,cAAQ,CAAa,EAAE,CAAC;IAAnDN,SAAS,GAAA+C,UAAA;IAAEC,YAAY,GAAAD,UAAA;EAE9B,IAAME,gBAAgB,GAAGC,iBAAW;IAAA;6BACZC,kBAAI,CAACC,eAAe,CAAC,YAAY,EAAER,kBAAkB,CAAC,EAAAS,IAAA,WAAtEC,OAAO;QACbR,UAAU,CAACQ,OAAO,CAAC;QACnBN,YAAY,CACVM,OAAO,CAAC5B,GAAG,CAAC,UAACb,IAAI;UACf,OAAO;YAAElB,KAAK,EAAEkB,IAAI,CAAClB;WAAO;SAC7B,CAAC,CACH;;KACF,QAAA4D,CAAA;MAAA,OAAAC,OAAA,CAAAC,MAAA,CAAAF,CAAA;;KAAE,EAAE,CAAC;EAENG,eAAS,CAAC;IACRT,gBAAgB,EAAE;IAClBU,SAAS,CAACC,YAAY,CAACC,gBAAgB,CAAC,cAAc,EAAEZ,gBAAgB,CAAC;IAEzE,OAAO;MACLU,SAAS,CAACC,YAAY,CAACE,mBAAmB,CAAC,cAAc,EAAEb,gBAAgB,CAAC;KAC7E;GACF,EAAE,EAAE,CAAC;EAEN,IAAMc,cAAc,GAAG,SAAjBA,cAAcA,CAAIlD,IAAc;IACpC,IAAMmD,MAAM,GAAGnB,OAAO,CAACoB,IAAI,CAAC,UAACC,CAAC;MAAA,OAAKA,CAAC,CAACvE,KAAK,KAAKkB,IAAI,CAAClB,KAAK;MAAC;IAC1D,IAAIqE,MAAM,IAAI3B,gBAAgB,EAAE;MAC9BA,gBAAgB,CAAC2B,MAAM,CAAC;;GAE3B;EAED,OACEhD,6BAACvB,aAAa;IACZE,KAAK,EAAEyC,OAAO,GAAGM,UAAU,GAAGF,QAAQ;IACtC1C,IAAI,EAAEsC,OAAO,GAAG+B,mCAAiB,GAAGC,8BAAY;IAChDxE,QAAQ,EAAE0C,gBAAgB;IAC1BzC,OAAO,EAAEA,OAAO;IAChBG,SAAS,EAAEA,SAAS;IACpBI,eAAe,EAAE2D,cAAc;IAC/BhE,SAAS,EAAEA,SAAS;IACpBE,yBAAyB,EAAEA,yBAAyB;IACpDC,0BAA0B,EAAEA,0BAA0B;IACtDC,mCAAmC,EAAEA;IACrC;AAEN,CAAC;;ICxDYkE,iBAAiB,GAAG,SAApBA,iBAAiBA,CAAA3E,IAAA;MAC5B4E,SAAS,GAAA5E,IAAA,CAAT4E,SAAS;IACTzE,OAAO,GAAAH,IAAA,CAAPG,OAAO;IACPwC,gBAAgB,GAAA3C,IAAA,CAAhB2C,gBAAgB;IAAAkC,gBAAA,GAAA7E,IAAA,CAChB8E,WAAW;IAAXA,WAAW,GAAAD,gBAAA,cAAG,eAAe,GAAAA,gBAAA;IAAAE,eAAA,GAAA/E,IAAA,CAC7BgF,UAAU;IAAVA,UAAU,GAAAD,eAAA,cAAG,cAAc,GAAAA,eAAA;IAAA9B,qBAAA,GAAAjD,IAAA,CAC3BkD,kBAAkB;IAAlBA,kBAAkB,GAAAD,qBAAA,cAAG,IAAI,GAAAA,qBAAA;IACzB5C,SAAS,GAAAL,IAAA,CAATK,SAAS;IACTuC,gBAAgB,GAAA5C,IAAA,CAAhB4C,gBAAgB;IAChBrC,yBAAyB,GAAAP,IAAA,CAAzBO,yBAAyB;IACzBC,0BAA0B,GAAAR,IAAA,CAA1BQ,0BAA0B;IAC1BC,mCAAmC,GAAAT,IAAA,CAAnCS,mCAAmC;EAEnC,IAAAE,SAAA,GAA8BC,cAAQ,CAAoB,EAAE,CAAC;IAAtDuC,OAAO,GAAAxC,SAAA;IAAEyC,UAAU,GAAAzC,SAAA;EAC1B,IAAA0C,UAAA,GAAkCzC,cAAQ,CAAa,EAAE,CAAC;IAAnDN,SAAS,GAAA+C,UAAA;IAAEC,YAAY,GAAAD,UAAA;EAE9B,IAAM4B,gBAAgB,GAAGzB,iBAAW;IAAA;6BACZC,kBAAI,CAACC,eAAe,CAAC,YAAY,EAAER,kBAAkB,CAAC,EAAAS,IAAA,WAAtEC,OAAO;QACbR,UAAU,CAACQ,OAAO,CAAC;QACnBN,YAAY,CACVM,OAAO,CAAC5B,GAAG,CAAC,UAACb,IAAI;UACf,OAAO;YAAElB,KAAK,EAAEkB,IAAI,CAAClB;WAAO;SAC7B,CAAC,CACH;;KACF,QAAA4D,CAAA;MAAA,OAAAC,OAAA,CAAAC,MAAA,CAAAF,CAAA;;KAAE,EAAE,CAAC;EAENG,eAAS,CAAC;IACRiB,gBAAgB,EAAE;IAClBhB,SAAS,CAACC,YAAY,CAACC,gBAAgB,CAAC,cAAc,EAAEc,gBAAgB,CAAC;IACzE,OAAO;MACLhB,SAAS,CAACC,YAAY,CAACE,mBAAmB,CAAC,cAAc,EAAEa,gBAAgB,CAAC;KAC7E;GACF,EAAE,EAAE,CAAC;EAEN,IAAMZ,cAAc,GAAG,SAAjBA,cAAcA,CAAIlD,IAAc;IACpC,IAAMmD,MAAM,GAAGnB,OAAO,CAACoB,IAAI,CAAC,UAACC,CAAC;MAAA,OAAKA,CAAC,CAACvE,KAAK,KAAKkB,IAAI,CAAClB,KAAK;MAAC;IAC1D,IAAIqE,MAAM,IAAI3B,gBAAgB,EAAE;MAC9BA,gBAAgB,CAAC2B,MAAM,CAAC;;GAE3B;EAED,OACEhD,6BAACvB,aAAa;IACZE,KAAK,EAAE2E,SAAS,GAAGE,WAAW,GAAGE,UAAU;IAC3C5E,IAAI,EAAEwE,SAAS,GAAGM,yBAAO,GAAGC,8BAAY;IACxCjF,QAAQ,EAAE0C,gBAAgB;IAC1BzC,OAAO,EAAEA,OAAO;IAChBG,SAAS,EAAEA,SAAS;IACpBI,eAAe,EAAE2D,cAAc;IAC/BhE,SAAS,EAAEA,SAAS;IACpBE,yBAAyB,EAAEA,yBAAyB;IACpDC,0BAA0B,EAAEA,0BAA0B;IACtDC,mCAAmC,EAAEA;IACrC;AAEN,CAAC;;ICzDY2E,YAAY,GAAG,SAAfA,YAAYA,CAAApF,IAAA;MACvBqF,IAAI,GAAArF,IAAA,CAAJqF,IAAI;IACJC,iBAAiB,GAAAtF,IAAA,CAAjBsF,iBAAiB;IACjBC,WAAW,GAAAvF,IAAA,CAAXuF,WAAW;IACXC,WAAW,GAAAxF,IAAA,CAAXwF,WAAW;IACXC,OAAO,GAAAzF,IAAA,CAAPyF,OAAO;EAEP,IAAAC,eAAA,GAAqEC,wBAAc,CACjFN,IAAI,CAACO,gBAAgB,CACtB;IAF0BC,MAAM,GAAAH,eAAA,CAAzBI,iBAAiB;IAAiCC,MAAM,GAAAL,eAAA,CAA7BM,qBAAqB;EAIxD,IAAIV,iBAAiB,KAAKW,SAAS,EAAE;IACnCX,iBAAiB,GAAG,IAAI;;EAE1B,IAAIE,WAAW,KAAKS,SAAS,EAAE;IAC7BT,WAAW,GAAG,IAAI;;EAEpB,IAAID,WAAW,KAAKU,SAAS,EAAE;IAC7BV,WAAW,GAAG,IAAI;;EAGpB,IAAAW,eAAA,GAAsD5E,cAAK,CAACV,QAAQ,CAAC,KAAK,CAAC;IAApEuF,mBAAmB,GAAAD,eAAA;IAAEE,sBAAsB,GAAAF,eAAA;EAClD,IAAIG,UAAoC;EACxC,IAAId,WAAW,EAAE;IAAA,IAAAe,eAAA;IACf,IAAMC,OAAO,GAAG,GAAAD,eAAA,GAAEP,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAErD,OAAO,YAAA4D,eAAA,GAAI,IAAI,CAAC;IAC1CD,UAAU,GACR/E,6BAACmB,iBAAiB;MAChBC,OAAO,EAAE,CAAC6D,OAAO;MACjB3D,gBAAgB,EAAEuD,mBAAmB;MACrChG,OAAO;QAAA;UACLiG,sBAAsB,CAAC,IAAI,CAAC;UAC5Bf,IAAI,CAACO,gBAAgB,CAClBY,oBAAoB,CAAC,CAACD,OAAO,CAAC,WACvB,CAAC;YAAA,OAAMH,sBAAsB,CAAC,KAAK,CAAC;YAAC;UAAC,OAAAtC,OAAA,CAAA2C,OAAA;SACjD,QAAA5C,CAAA;UAAA,OAAAC,OAAA,CAAAC,MAAA,CAAAF,CAAA;;;MACDlB,gBAAgB,EAAE,SAAAA,iBAAC2B,MAAM;QACvB8B,sBAAsB,CAAC,IAAI,CAAC;QAC5Bf,IAAI,CACDqB,kBAAkB,CAAC,YAAY,EAAEpC,MAAM,CAACqC,QAAQ,CAAC,WAC1C,CAAC;UAAA,OAAMP,sBAAsB,CAAC,KAAK,CAAC;UAAC;;MAGpD;;EAGH,IAAAQ,gBAAA,GAAsDtF,cAAK,CAACV,QAAQ,CAAC,KAAK,CAAC;IAApEiG,mBAAmB,GAAAD,gBAAA;IAAEE,sBAAsB,GAAAF,gBAAA;EAElD,IAAIG,WAAqC;EACzC,IAAIvB,WAAW,EAAE;IAAA,IAAAwB,eAAA;IACf,IAAMT,QAAO,GAAG,GAAAS,eAAA,GAAEnB,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEnD,OAAO,YAAAsE,eAAA,GAAI,IAAI,CAAC;IAC1CD,WAAW,GACTzF,6BAACqD,iBAAiB;MAChBC,SAAS,EAAE2B,QAAO;MAClB3D,gBAAgB,EAAEiE,mBAAmB;MACrC1G,OAAO,EAAE,SAAAA;QACP2G,sBAAsB,CAAC,IAAI,CAAC;QAC5BzB,IAAI,CAACO,gBAAgB,CAClBqB,gBAAgB,CAAC,CAACV,QAAO,CAAC,WACnB,CAAC;UAAA,OAAMO,sBAAsB,CAAC,KAAK,CAAC;UAAC;OAChD;MACDnE,gBAAgB,EAAE,SAAAA,iBAAC2B,MAAM;QACvBwC,sBAAsB,CAAC,IAAI,CAAC;QAC5BzB,IAAI,CACDqB,kBAAkB,CAAC,YAAY,EAAEpC,MAAM,CAACqC,QAAQ,CAAC,WAC1C,CAAC;UAAA,OAAMG,sBAAsB,CAAC,KAAK,CAAC;UAAC;;MAGpD;;EAGH,IAAAI,gBAAA,GAAwD5F,cAAK,CAACV,QAAQ,CAAC,KAAK,CAAC;IAAtEuG,oBAAoB,GAAAD,gBAAA;IAAEE,uBAAuB,GAAAF,gBAAA;EACpD,IAAIG,YAAsC;EAC1C,IAAI/B,iBAAiB,EAAE;IACrB,IAAMiB,SAAO,GAAGlB,IAAI,CAACO,gBAAgB,CAAC0B,oBAAoB;IAC1DD,YAAY,GACV/F,6BAACvB,aAAa;MACZE,KAAK,EAAEsG,SAAO,GAAG,cAAc,GAAG,cAAc;MAChDnG,IAAI,EAAEmG,SAAO,GAAGgB,wBAAM,GAAGC,2BAAS;MAClCtH,QAAQ,EAAEiH,oBAAoB;MAC9BhH,OAAO,EAAE,SAAAA;QACPiH,uBAAuB,CAAC,IAAI,CAAC;QAC7B/B,IAAI,CAACO,gBAAgB,CAClB6B,qBAAqB,CAAC,CAAClB,SAAO,CAAC,WACxB,CAAC;UAAA,OAAMa,uBAAuB,CAAC,KAAK,CAAC;UAAC;;MAGrD;;EAGH,OACE9F;IAAKjB,SAAS,EAAEW,MAAM,CAAC0G;KACpBrB,UAAU,EACVU,WAAW,EACXM,YAAY,EACZ5B,OAAO,IACNnE,6BAACvB,aAAa;IACZE,KAAK,EAAC,KAAK;IACXI,SAAS,EAAEW,MAAM,CAAC2G,YAAY;IAC9BxH,OAAO,EAAE,SAAAA;MACPkF,IAAI,CAACuC,UAAU,EAAE;MACjBnC,OAAO,CAACJ,IAAI,CAAC;;IAGlB,CACG;AAEV,CAAC;;ICnHYwC,cAAc,GAAGvG,cAAK,CAACwG,aAAa,CAAiB;EAChEC,WAAW,EAAE,MAAM;EACnBC,SAAS,EAAE;CACZ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IC4CWC,eAAe,GAAG,SAAlBA,eAAeA,CAAAjI,IAAA;MAC1BkI,WAAW,GAAAlI,IAAA,CAAXkI,WAAW;IACXC,KAAK,GAAAnI,IAAA,CAALmI,KAAK;IACLvG,MAAM,GAAA5B,IAAA,CAAN4B,MAAM;IACNvB,SAAS,GAAAL,IAAA,CAATK,SAAS;IACT+H,gBAAgB,GAAApI,IAAA,CAAhBoI,gBAAgB;IAChBC,WAAW,GAAArI,IAAA,CAAXqI,WAAW;IACXC,YAAY,GAAAtI,IAAA,CAAZsI,YAAY;IACZC,WAAW,GAAAvI,IAAA,CAAXuI,WAAW;IACXC,WAAW,GAAAxI,IAAA,CAAXwI,WAAW;IACXC,WAAW,GAAAzI,IAAA,CAAXyI,WAAW;IACXC,qBAAqB,GAAA1I,IAAA,CAArB0I,qBAAqB;IACrBC,YAAY,GAAA3I,IAAA,CAAZ2I,YAAY;IACZC,YAAY,GAAA5I,IAAA,CAAZ4I,YAAY;IACZzI,OAAO,GAAAH,IAAA,CAAPG,OAAO;EAEP,IAAAuF,eAAA,GACEC,wBAAc,CAACuC,WAAW,CAAC;IADrBpC,iBAAiB,GAAAJ,eAAA,CAAjBI,iBAAiB;IAAE+C,OAAO,GAAAnD,eAAA,CAAPmD,OAAO;IAAEC,iBAAiB,GAAApD,eAAA,CAAjBoD,iBAAiB;IAAEC,UAAU,GAAArD,eAAA,CAAVqD,UAAU;EAEjE,IAAApI,SAAA,GAAkCC,cAAQ,EAAU;IAA7CoI,SAAS,GAAArI,SAAA;IAAEsI,YAAY,GAAAtI,SAAA;EAC9B,IAAA0C,UAAA,GAA4CzC,cAAQ,EAAU;IAAvDsI,cAAc,GAAA7F,UAAA;IAAE8F,iBAAiB,GAAA9F,UAAA;EACxC,IAAM+F,OAAO,GAAGC,gBAAU,CAACxB,cAAc,CAAC;EAE1C,IAAMyB,YAAY,GAAG9F,iBAAW,CAAC,UAAC2E,KAAa,EAAEvG,MAAc;IAC7DqH,YAAY,CAAId,KAAK,SAAIvG,MAAQ,CAAC;GACnC,EAAE,EAAE,CAAC;EAENoC,eAAS,CAAC;IACR,IAAMuF,QAAQ,GAAGC,WAAW,CAAC;MAC3B,IAAIC,KAAK,GAAG,CAAC;MACbvB,WAAW,CAACwB,MAAM,CAACC,OAAO,CAAC,UAACC,GAAG;QAC7B,IACEA,GAAG,CAACC,KAAK,YAAYC,wBAAU,IAC/BF,GAAG,CAACC,KAAK,YAAYE,yBAAW,EAChC;UACAN,KAAK,IAAIG,GAAG,CAACC,KAAK,CAACX,cAAc;;OAEpC,CAAC;MACFC,iBAAiB,CAACM,KAAK,CAAC;KACzB,EAAE,IAAI,CAAC;IACR,OAAO;MACLO,aAAa,CAACT,QAAQ,CAAC;KACxB;GACF,EAAE,EAAE,CAAC;EAEN,IAAMU,eAAe,GAAkB;IACrC9B,KAAK,EAAEA,KAAK;IACZvG,MAAM,EAAEA;GACT;EAGD,IAAIsI,SAAS,GAAuB,SAAS;EAC7C,IAAIC,gBAAsD;EAC1D,IAAI,CAAC5B,WAAW,IAAIF,WAAW,IAAIC,YAAY,EAAE;IAC/CC,WAAW,GAAGF,WAAW,GAAGC,YAAY,GAAG,WAAW,GAAG,UAAU;;EAErE,IAAIxC,iBAAiB,aAAjBA,iBAAiB,eAAjBA,iBAAiB,CAAEsE,UAAU,EAAE;IACjCD,gBAAgB,GACdrE,iBAAiB,CAACsE,UAAU,CAACjC,KAAK,GAAGrC,iBAAiB,CAACsE,UAAU,CAACxI,MAAM,GACpE,WAAW,GACX,UAAU;;EAGlB,IAAIuI,gBAAgB,KAAK5B,WAAW,EAAE;IACpC2B,SAAS,GAAG,OAAO;;EAGrB,IAAI,CAAC1B,WAAW,EAAE;IAChBA,WAAW,GAAGN,WAAW,CAACmC,IAAI,IAAInC,WAAW,CAACoC,QAAQ;IACtD,IAAIzB,OAAO,EAAE;MACXL,WAAW,IAAI,QAAQ;;;EAI3B,IAAI+B,WAAyB;EAC7B,IACEzE,iBAAiB,aAAjBA,iBAAiB,eAAjBA,iBAAiB,CAAE0E,YAAY,IAC/B1E,iBAAiB,aAAjBA,iBAAiB,eAAjBA,iBAAiB,CAAE+D,KAAK,IACxB,EAAC/D,iBAAiB,aAAjBA,iBAAiB,eAAjBA,iBAAiB,CAAEpD,OAAO,GAC3B;IACA6H,WAAW,GACTjJ,6BAACmJ,uBAAa;MACZZ,KAAK,EAAE/D,iBAAiB,CAAC+D,KAAK;MAC9BhB,OAAO,EAAEA,OAAO;MAChBqB,SAAS,EAAEA,SAAS;MACpB/B,KAAK,EAAC,MAAM;MACZvG,MAAM,EAAC,MAAM;MACbvB,SAAS,EAAEW,MAAM,CAAC0J,KAAK;MACvBC,aAAa,EAAErB;MAElB;GACF,MAAM;IACLiB,WAAW,GAAGjJ;MAAKjB,SAAS,EAAEW,MAAM,CAAC4J;MAAe;;EAGtD,IAAM7J,OAAO,GAAG,CAACC,MAAM,CAACkH,WAAW,CAAC;EACpC,IAAI7H,SAAS,EAAE;IACbU,OAAO,CAAC8J,IAAI,CAACxK,SAAS,CAAC;;EAEzB,IAAI0I,UAAU,EAAE;IACdhI,OAAO,CAAC8J,IAAI,CAACzC,gBAAgB,WAAhBA,gBAAgB,GAAIpH,MAAM,CAAC8J,OAAO,CAAC;;EAElD,IAAMC,YAAY,GAAG,CAAC7C,WAAW,CAAC8C,mBAAmB;EAGrD,IAAIC,YAAsC;EAC1C,IAAI7B,OAAO,CAACpB,SAAS,EAAE;IACrBiD,YAAY,GACV3J;MAAKjB,SAAS,EAAEW,MAAM,CAACkK;OACrB5J,2CAAO0H,SAAS,CAAQ,EACvBE,cAAc,KAAKjD,SAAS,IAAIiD,cAAc,GAAG,CAAC,IACjD5H,mDAAa6J,IAAI,CAACC,KAAK,CAAClC,cAAc,GAAG,IAAI,CAAC,UAC/C,CAEJ;;EAGH,IAAImC,0BAAiE;EACrE,IAAI3C,qBAAqB,EAAE;IACzB,QAAQI,iBAAiB;MACvB,KAAKwC,+BAAiB,CAACC,SAAS;QAC9BF,0BAA0B,GAAGG,qBAAkB;QAC/C;MACF,KAAKF,+BAAiB,CAACG,IAAI;QACzBJ,0BAA0B,GAAGK,qBAAkB;QAC/C;MACF,KAAKJ,+BAAiB,CAACK,IAAI;QACzBN,0BAA0B,GAAGO,qBAAkB;QAC/C;;;EAIN,OACEtK;IACEjB,SAAS,EAAEU,OAAO,CAAC8K,IAAI,CAAC,GAAG,CAAC;IAC5BC,KAAK,EAAE7B,eAAe;IACtBtB,YAAY,EAAEA,YAAY;IAC1BC,YAAY,EAAEA,YAAY;IAC1BzI,OAAO,EAAEA;KAERkI,WAAW,IAAIC,YAAY,IAC1BhH,6BAACyK,4BAAW;IAACC,KAAK,EAAE3D,WAAW,GAAGC;KAC/BiC,WAAW,CAEf,EACA,CAAC,CAAClC,WAAW,IAAI,CAACC,YAAY,KAAKiC,WAAW,EAE9C,CAAC9B,WAAW,IAAIW,OAAO,CAACpB,SAAS,KAChC1G;IAAKjB,SAAS,EAAEW,MAAM,CAACiL;KACrB3K;IAAKjB,SAAS,EAAEW,MAAM,CAACqJ;KAAO7B,WAAW,CAAO,EAChDlH;IAAKjB,SAAS,EAAEW,MAAM,CAACkL;KAASjB,YAAY,CAAO,EACnD3J,0CACG+J,0BAA0B,IAAI/J,6BAAC+J,0BAA0B,OAAG,CACzD,EACN/J,0CACEA,6BAACK,gCAAe;IACdvB,IAAI,EAAE2K,YAAY,GAAGtG,mCAAiB,GAAGC,8BAAY;IACrD9C,MAAM,EAAE,EAAE;IACVvB,SAAS,EAAE0K,YAAY,GAAG/J,MAAM,CAACmL,OAAO,GAAGnL,MAAM,CAACoL;IAClD,CACE,CAET,CACG;AAEV,CAAC;;IC9MYC,eAAe,GAAG,SAAlBA,eAAeA,CAAArM,IAAA;MAAM6J,KAAK,GAAA7J,IAAA,CAAL6J,KAAK;IAAE1B,KAAK,GAAAnI,IAAA,CAALmI,KAAK;IAAEvG,MAAM,GAAA5B,IAAA,CAAN4B,MAAM;EACpD,OACEN;IAAKjB,SAAS,EAAEW,MAAM,CAACsL;KACrBhL,6BAACmJ,uBAAa;IACZZ,KAAK,EAAEA,KAAK;IACZhB,OAAO,EAAE,KAAK;IACdV,KAAK,EAAEA,KAAK;IACZvG,MAAM,EAAEA,MAAM;IACdvB,SAAS,EAAEW,MAAM,CAAC0J;IAClB,CACE;AAEV,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClBM,IAAM6B,SAAS,GAAG,SAAZA,SAASA,CAAAvM,IAAA;MACpBwM,SAAS,GAAAxM,IAAA,CAATwM,SAAS;IACTC,mBAAmB,GAAAzM,IAAA,CAAnByM,mBAAmB;IACnBC,eAAe,GAAA1M,IAAA,CAAf0M,eAAe;IACfjH,OAAO,GAAAzF,IAAA,CAAPyF,OAAO;EAEP,IAAQkH,YAAY,GAAgCH,SAAS,CAArDG,YAAY;IAAEC,KAAK,GAAyBJ,SAAS,CAAvCI,KAAK;IAAEC,YAAY,GAAWL,SAAS,CAAhCK,YAAY;IAAExH,IAAI,GAAKmH,SAAS,CAAlBnH,IAAI;EAC/C,IAAA1E,SAAA,GAAsDC,cAAQ,CAAgB,EAAE,CAAC;IAA1EkM,mBAAmB,GAAAnM,SAAA;IAAEoM,sBAAsB,GAAApM,SAAA;EAClD,IAAA0C,UAAA,GAAsCzC,cAAQ,CAAC,KAAK,CAAC;IAA9C6H,WAAW,GAAApF,UAAA;IAAE2J,cAAc,GAAA3J,UAAA;EAClC,IAAA6C,eAAA,GAAkC5E,cAAK,CAACV,QAAQ,CAACI,QAAM,CAACiM,OAAO,CAAC;IAAzDC,SAAS,GAAAhH,eAAA;IAAEiH,YAAY,GAAAjH,eAAA;EAG9BlC,eAAS,CAAC;;IAER,IAAIoJ,UAAU,GAAG,CAAC;IAClB,IAAIP,YAAY,CAACtL,MAAM,KAAK,CAAC,EAAE;MAC7B4L,YAAY,CAACnM,QAAM,CAACiM,OAAO,CAAC;KAC7B,MAAM,IAAIJ,YAAY,CAACtL,MAAM,KAAK,CAAC,EAAE;MACpC4L,YAAY,CAACnM,QAAM,CAACqM,OAAO,CAAC;MAC5BD,UAAU,GAAG,CAAC;KACf,MAAM,IAAIP,YAAY,CAACtL,MAAM,IAAI,CAAC,EAAE;MACnC4L,YAAY,CAACnM,QAAM,CAACsM,OAAO,CAAC;MAC5BF,UAAU,GAAGjC,IAAI,CAACoC,GAAG,CAACV,YAAY,CAACtL,MAAM,EAAE,CAAC,CAAC;KAC9C,MAAM,IAAIsL,YAAY,CAACtL,MAAM,IAAI,CAAC,EAAE;MACnC4L,YAAY,CAACnM,QAAM,CAACwM,OAAO,CAAC;MAC5BJ,UAAU,GAAGjC,IAAI,CAACoC,GAAG,CAACV,YAAY,CAACtL,MAAM,EAAE,CAAC,CAAC;KAC9C,MAAM,IAAIsL,YAAY,CAACtL,MAAM,IAAI,EAAE,EAAE;MACpC4L,YAAY,CAACnM,QAAM,CAACyM,OAAO,CAAC;MAC5BL,UAAU,GAAGjC,IAAI,CAACoC,GAAG,CAACV,YAAY,CAACtL,MAAM,EAAE,EAAE,CAAC;KAC/C,MAAM;MACL4L,YAAY,CAACnM,QAAM,CAAC0M,OAAO,CAAC;MAC5BN,UAAU,GAAGjC,IAAI,CAACoC,GAAG,CAACV,YAAY,CAACtL,MAAM,EAAE,EAAE,CAAC;;IAIhD,IAAMoM,eAAe,GAAkB,EAAE;IACzCb,mBAAmB,CAACnD,OAAO,CAAC,UAACiE,CAAC;MAC5B,IAAIvI,IAAI,aAAJA,IAAI,eAAJA,IAAI,CAAEwH,YAAY,CAACgB,GAAG,CAACD,CAAC,CAACE,GAAG,CAAC,IAAI,CAAAzI,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEO,gBAAgB,CAACkI,GAAG,MAAKF,CAAC,CAACE,GAAG,EAAE;QACzEH,eAAe,CAAC9C,IAAI,CAAC+C,CAAC,CAAC;;KAE1B,CAAC;IAGFvI,IAAI,aAAJA,IAAI,wBAAA0I,oBAAA,GAAJ1I,IAAI,CAAE2I,cAAc,cAAAD,oBAAA,uBAApBA,oBAAA,CAAsBpE,OAAO,CAAC,UAACmB,OAAO;MACpC,IACE6C,eAAe,CAACM,QAAQ,CAACnD,OAAO,CAAC,IAChCA,OAAO,MAAKzF,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEO,gBAAgB,KAAI,EAACP,IAAI,aAAJA,IAAI,eAAJA,IAAI,CAAEwH,YAAY,CAACgB,GAAG,CAAC/C,OAAO,CAACgD,GAAG,CAAC,CAAC,EAC5E;QACA;;MAGF,IAAMI,GAAG,GAAGP,eAAe,CAACQ,SAAS,CAAC,UAACP,CAAC;QAAA,OAAK,CAACA,CAAC,CAAC7E,UAAU;QAAC;MAC3D,IAAImF,GAAG,IAAI,CAAC,EAAE;QACZP,eAAe,CAACO,GAAG,CAAC,GAAGpD,OAAO;OAC/B,MAAM;QACL6C,eAAe,CAAC9C,IAAI,CAACC,OAAO,CAAC;;KAEhC,CAAC;IAGF,SAAAsD,SAAA,GAAAC,+BAAA,CAAgBxB,YAAY,GAAAyB,KAAA,IAAAA,KAAA,GAAAF,SAAA,IAAAG,IAAA,GAAE;MAAA,IAAnBX,CAAC,GAAAU,KAAA,CAAAE,KAAA;MACV,IAAIb,eAAe,CAACpM,MAAM,IAAI6L,UAAU,EAAE;QACxC;;MAEF,IAAIO,eAAe,CAACM,QAAQ,CAACL,CAAC,CAAC,IAAIA,CAAC,CAAC7E,UAAU,EAAE;QAC/C;;MAEF4E,eAAe,CAAC9C,IAAI,CAAC+C,CAAC,CAAC;;IAGzB,IAAID,eAAe,CAACpM,MAAM,GAAG6L,UAAU,EAAE;MACvCO,eAAe,CAACc,MAAM,CAACrB,UAAU,EAAEO,eAAe,CAACpM,MAAM,GAAG6L,UAAU,CAAC;;IAEzEL,sBAAsB,CAACY,eAAe,CAAC;GACxC,EAAE,CAACd,YAAY,CAAC,CAAC;EAElB,IAAID,KAAK,EAAE;IACT,OAAOtL,oDAAYsL,KAAK,CAAC8B,OAAO,CAAO;;EAGzC,IAAI/B,YAAY,EAAE;IAChB,OAAOrL,0EAAwC;;EAEjD,IAAI,CAAC+D,IAAI,EAAE;IACT,OAAO/D,oEAAkC;;EAG3C,IAAIuL,YAAY,CAACtL,MAAM,KAAK,CAAC,EAAE;IAC7B,OAAOD,kEAAgC;;EAGzC,IAAMqN,mBAAmB,GAAGlC,mBAAmB,WAAnBA,mBAAmB,GAAIxE,eAAe;EAClE,IAAM2G,eAAe,GAAGlC,eAAe,WAAfA,eAAe,GAAItH,YAAY;EAEvD,OAEE9D;IAAKjB,SAAS,EAAEW,QAAM,CAAC6N;KACrBvN;IAAKjB,SAAS,EAAKW,QAAM,CAAC8N,SAAS,SAAI5B;KACpCJ,mBAAmB,CAAC9K,GAAG,CAAC,UAACkG,WAAW;IACnC,OACE5G,6BAACqN,mBAAmB;MAClBzM,GAAG,EAAEgG,WAAW,CAACoC,QAAQ;MACzBpC,WAAW,EAAEA,WAAW;MACxBK,WAAW,EAAC,WAAW;MACvBJ,KAAK,EAAC,MAAM;MACZvG,MAAM,EAAC,MAAM;MACb6G,WAAW,EAAEA,WAAW;MACxBC,qBAAqB;MACrBC,YAAY,EAAE,SAAAA;QAAA,OAAMqE,cAAc,CAAC,IAAI,CAAC;;MACxCpE,YAAY,EAAE,SAAAA;QAAA,OAAMoE,cAAc,CAAC,KAAK,CAAC;;MACzC;GAEL,CAAC,CACE,EACN1L;IAAKjB,SAAS,EAAEW,QAAM,CAAC+N;KACrBzN,6BAACsN,eAAe;IAACvJ,IAAI,EAAEA,IAAI;IAAEI,OAAO,EAAEA;IAAW,CAC7C,CACF;AAEV,CAAC;;SCpHeuJ,uBAAuBA,CAACnC,YAA2B;EACjE,IAAMoC,kBAAkB,MAAAC,MAAA,CAAOrC,YAAY,CAAC;EAC5CoC,kBAAkB,CAACE,IAAI,CAAC,UAACC,CAAC,EAAEC,CAAC;;IAE3B,IAAID,CAAC,CAACrG,UAAU,IAAIsG,CAAC,CAACtG,UAAU,EAAE;MAChC,OAAOsG,CAAC,CAACC,UAAU,GAAGF,CAAC,CAACE,UAAU;;IAIpC,IAAIF,CAAC,CAACrG,UAAU,KAAKsG,CAAC,CAACtG,UAAU,EAAE;MACjC,IAAIqG,CAAC,CAACrG,UAAU,EAAE;QAChB,OAAO,CAAC,CAAC;OACV,MAAM;QACL,OAAO,CAAC;;;IAKZ,IAAIqG,CAAC,CAACG,WAAW,KAAKF,CAAC,CAACE,WAAW,EAAE;MAAA,IAAAC,qBAAA,EAAAC,cAAA,EAAAC,qBAAA,EAAAC,cAAA;MACnC,IAAMC,KAAK,IAAAJ,qBAAA,IAAAC,cAAA,GAAGL,CAAC,CAACG,WAAW,cAAAE,cAAA,uBAAbA,cAAA,CAAeI,OAAO,EAAE,YAAAL,qBAAA,GAAI,CAAC;MAC3C,IAAMM,KAAK,IAAAJ,qBAAA,IAAAC,cAAA,GAAGN,CAAC,CAACE,WAAW,cAAAI,cAAA,uBAAbA,cAAA,CAAeE,OAAO,EAAE,YAAAH,qBAAA,GAAI,CAAC;MAC3C,OAAOI,KAAK,GAAGF,KAAK;;IAItB,IAAMG,MAAM,GAAGX,CAAC,CAACY,WAAW,CAACC,IAAI,GAAG,CAAC;IACrC,IAAMC,MAAM,GAAGb,CAAC,CAACW,WAAW,CAACC,IAAI,GAAG,CAAC;IACrC,IAAIF,MAAM,KAAKG,MAAM,EAAE;MACrB,IAAIH,MAAM,EAAE;QACV,OAAO,CAAC,CAAC;OACV,MAAM;QACL,OAAO,CAAC;;;IAKZ,OAAO,EAAAI,mBAAA,IAAAC,WAAA,GAAChB,CAAC,CAACiB,QAAQ,cAAAD,WAAA,uBAAVA,WAAA,CAAYP,OAAO,EAAE,YAAAM,mBAAA,GAAI,CAAC,MAAAG,mBAAA,IAAAC,WAAA,GAAKlB,CAAC,CAACgB,QAAQ,cAAAE,WAAA,uBAAVA,WAAA,CAAYV,OAAO,EAAE,YAAAS,mBAAA,GAAI,CAAC,CAAC;GACnE,CAAC;EACF,IAAM1K,gBAAgB,GAAGqJ,kBAAkB,CAAC1K,IAAI,CAAC,UAACqJ,CAAC;IAAA,OAAKA,CAAC,YAAY4C,8BAAgB;IAAC;EACtF,IAAI5K,gBAAgB,EAAE;IACpB,IAAM6K,QAAQ,GAAGxB,kBAAkB,CAACyB,OAAO,CAAC9K,gBAAgB,CAAC;IAC7D,IAAI6K,QAAQ,IAAI,CAAC,EAAE;MACjBxB,kBAAkB,CAACR,MAAM,CAACgC,QAAQ,EAAE,CAAC,CAAC;MACtC,IAAIxB,kBAAkB,CAAC1N,MAAM,GAAG,CAAC,EAAE;QACjC0N,kBAAkB,CAACR,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE7I,gBAAgB,CAAC;OAClD,MAAM;QACLqJ,kBAAkB,CAACpE,IAAI,CAACjF,gBAAgB,CAAC;;;;EAI/C,OAAOqJ,kBAAkB;AAC3B;;ACpDO,IAAM0B,YAAY,GAAG,SAAfA,YAAYA,CAAA3Q,IAAA;MACvBwM,SAAS,GAAAxM,IAAA,CAATwM,SAAS;IACTC,mBAAmB,GAAAzM,IAAA,CAAnByM,mBAAmB;IACnBC,eAAe,GAAA1M,IAAA,CAAf0M,eAAe;IACfjH,OAAO,GAAAzF,IAAA,CAAPyF,OAAO;IACPmL,gBAAgB,GAAA5Q,IAAA,CAAhB4Q,gBAAgB;EAEhB,IAAQjE,YAAY,GAAgCH,SAAS,CAArDG,YAAY;IAAEC,KAAK,GAAyBJ,SAAS,CAAvCI,KAAK;IAAEC,YAAY,GAAWL,SAAS,CAAhCK,YAAY;IAAExH,IAAI,GAAKmH,SAAS,CAAlBnH,IAAI;EAC/C,IAAA1E,SAAA,GAAsCC,cAAQ,CAAC,KAAK,CAAC;IAA9C6H,WAAW,GAAA9H,SAAA;IAAEqM,cAAc,GAAArM,SAAA;EAClC,IAAMkQ,MAAM,GAAGD,gBAAgB,WAAhBA,gBAAgB,GAAI5B,uBAAuB;EAC1D,IAAA3L,UAAA,GAAoDzC,cAAQ,CAACiQ,MAAM,CAAChE,YAAY,CAAC,CAAC;IAA3EoC,kBAAkB,GAAA5L,UAAA;IAAEyN,qBAAqB,GAAAzN,UAAA;EAEhDW,eAAS,CAAC;IACR8M,qBAAqB,CAACD,MAAM,CAAChE,YAAY,CAAC,CAAC;GAC5C,EAAE,CAACA,YAAY,EAAEgE,MAAM,CAAC,CAAC;EAE1B,IAAIjE,KAAK,EAAE;IACT,OAAOtL,oDAAYsL,KAAK,CAAC8B,OAAO,CAAO;;EAGzC,IAAI/B,YAAY,EAAE;IAChB,OAAOrL,uDAAqB;;EAE9B,IAAI,CAAC+D,IAAI,EAAE;IACT,OAAO/D,wDAAsB;;EAG/B,IAAI2N,kBAAkB,CAAC1N,MAAM,KAAK,CAAC,EAAE;IACnC,OAAOD,kEAAgC;;EAGzC,IAAMqN,mBAAmB,GAAGlC,mBAAmB,WAAnBA,mBAAmB,GAAIxE,eAAe;EAClE,IAAM2G,eAAe,GAAGlC,eAAe,WAAfA,eAAe,GAAItH,YAAY;EAGvD,IAAI2L,WAAmC;EACvC9B,kBAAkB,CAACtF,OAAO,CAAC,UAACiE,CAAC;IAC3B,IAAImD,WAAW,EAAE;MACf;;IAEF,IAAMlH,KAAK,GAAG+D,CAAC,CAACoD,QAAQ,CAACC,mBAAK,CAACC,MAAM,CAACC,WAAW,CAAC;IAClD,IAAItH,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEW,YAAY,IAAIX,KAAK,CAACuH,UAAU,EAAE;MAC3CL,WAAW,GAAGlH,KAAK,CAACuH,UAAU;;GAEjC,CAAC;EAEF,IAAIC,iBAAiB,GAAGpC,kBAAkB;EAC1C,IAAIqC,kBAA+B;EACnC,IAAIC,QAAsB;EAC1B,IAAIR,WAAW,EAAE;IACfQ,QAAQ,GAAGjQ,6BAAC+K,eAAe;MAACxC,KAAK,EAAEkH,WAAW;MAAEnP,MAAM,EAAC,MAAM;MAACuG,KAAK,EAAC;MAAS;GAC9E,MAAM;IACJmJ,kBAAkB,GAA0BrC,kBAAkB;IAAvCoC,iBAAiB,GAAIpC,kBAAkB,CAAAuC,KAAA;IAC/DD,QAAQ,GACNjQ,6BAACqN,mBAAmB;MAClBzM,GAAG,EAAEoP,kBAAkB,CAAChH,QAAQ;MAChCpC,WAAW,EAAEoJ,kBAAkB;MAC/BnJ,KAAK,EAAC,MAAM;MACZvG,MAAM,EAAC,MAAM;MACb2G,WAAW,EAAC,WAAW;MACvBE,WAAW,EAAEA,WAAW;MACxBC,qBAAqB;MACrBC,YAAY,EAAE,SAAAA;QAAA,OAAMqE,cAAc,CAAC,IAAI,CAAC;;MACxCpE,YAAY,EAAE,SAAAA;QAAA,OAAMoE,cAAc,CAAC,KAAK,CAAC;;MAE5C;;EAGH,OAEE1L;IAAKjB,SAAS,EAAEW,QAAM,CAAC6N;KACrBvN;IAAKjB,SAAS,EAAEW,QAAM,CAACyQ;KACrBnQ;IAAKjB,SAAS,EAAEW,QAAM,CAAC0Q;KAAcH,QAAQ,CAAO,EACpDjQ;IAAKjB,SAAS,EAAEW,QAAM,CAAC2Q;KACpBN,iBAAiB,CAACrP,GAAG,CAAC,UAACkG,WAAW;IACjC,OACE5G,6BAACqN,mBAAmB;MAClBzM,GAAG,EAAEgG,WAAW,CAACoC,QAAQ;MACzBpC,WAAW,EAAEA,WAAW;MACxBC,KAAK,EAAC,MAAM;MACZE,WAAW,EAAE,EAAE;MACfC,YAAY,EAAE,CAAC;MACfG,WAAW,EAAEA,WAAW;MACxBE,YAAY,EAAE,SAAAA;QAAA,OAAMqE,cAAc,CAAC,IAAI,CAAC;;MACxCpE,YAAY,EAAE,SAAAA;QAAA,OAAMoE,cAAc,CAAC,KAAK,CAAC;;MACzC;GAEL,CAAC,CACE,CACF,EACN1L;IAAKjB,SAAS,EAAEW,QAAM,CAAC+N;KACrBzN,6BAACsN,eAAe;IAACvJ,IAAI,EAAEA,IAAI;IAAEI,OAAO,EAAEA;IAAW,CAC7C,CACF;AAEV,CAAC;;;;AC/FM,IAAMmM,WAAW,GAAG,SAAdA,WAAWA,CAAA5R,IAAA;MACtBwM,SAAS,GAAAxM,IAAA,CAATwM,SAAS;IACTC,mBAAmB,GAAAzM,IAAA,CAAnByM,mBAAmB;IACnBC,eAAe,GAAA1M,IAAA,CAAf0M,eAAe;IACfjH,OAAO,GAAAzF,IAAA,CAAPyF,OAAO;IACPmL,gBAAgB,GAAA5Q,IAAA,CAAhB4Q,gBAAgB;EAEhB,IAAQjE,YAAY,GAAgCH,SAAS,CAArDG,YAAY;IAAEC,KAAK,GAAyBJ,SAAS,CAAvCI,KAAK;IAAEC,YAAY,GAAWL,SAAS,CAAhCK,YAAY;IAAExH,IAAI,GAAKmH,SAAS,CAAlBnH,IAAI;EAC/C,IAAA1E,SAAA,GAAsCC,cAAQ,CAAC,KAAK,CAAC;IAA9C6H,WAAW,GAAA9H,SAAA;IAAEqM,cAAc,GAAArM,SAAA;EAClC,IAAMkQ,MAAM,GAAGD,gBAAgB,WAAhBA,gBAAgB,GAAI5B,uBAAuB;EAC1D,IAAA3L,UAAA,GAAoDzC,cAAQ,CAACiQ,MAAM,CAAChE,YAAY,CAAC,CAAC;IAA3EoC,kBAAkB,GAAA5L,UAAA;IAAEyN,qBAAqB,GAAAzN,UAAA;EAEhDW,eAAS,CAAC;IACR8M,qBAAqB,CAACD,MAAM,CAAChE,YAAY,CAAC,CAAC;GAC5C,EAAE,CAACA,YAAY,EAAEgE,MAAM,CAAC,CAAC;EAE1B,IAAIjE,KAAK,EAAE;IACT,OAAOtL,oDAAYsL,KAAK,CAAC8B,OAAO,CAAO;;EAGzC,IAAI/B,YAAY,EAAE;IAChB,OAAOrL,uDAAqB;;EAE9B,IAAI,CAAC+D,IAAI,EAAE;IACT,OAAO/D,wDAAsB;;EAG/B,IAAI2N,kBAAkB,CAAC1N,MAAM,KAAK,CAAC,EAAE;IACnC,OAAOD,kEAAgC;;EAGzC,IAAMqN,mBAAmB,GAAGlC,mBAAmB,WAAnBA,mBAAmB,GAAIxE,eAAe;EAClE,IAAM2G,eAAe,GAAGlC,eAAe,WAAfA,eAAe,GAAItH,YAAY;EAGvD,IAAI2L,WAAmC;EACvC9B,kBAAkB,CAACtF,OAAO,CAAC,UAACiE,CAAC;IAC3B,IAAImD,WAAW,EAAE;MACf;;IAEF,IAAMlH,KAAK,GAAG+D,CAAC,CAACoD,QAAQ,CAACC,mBAAK,CAACC,MAAM,CAACC,WAAW,CAAC;IAClD,IAAItH,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEW,YAAY,IAAIX,KAAK,CAACuH,UAAU,EAAE;MAC3CL,WAAW,GAAGlH,KAAK,CAACuH,UAAU;;GAEjC,CAAC;EAEF,IAAIC,iBAAiB,GAAGpC,kBAAkB;EAC1C,IAAIqC,kBAA+B;EACnC,IAAIC,QAAsB;EAC1B,IAAIR,WAAW,EAAE;IACfQ,QAAQ,GAAGjQ,6BAAC+K,eAAe;MAACxC,KAAK,EAAEkH,WAAW;MAAEnP,MAAM,EAAC,MAAM;MAACuG,KAAK,EAAC;MAAS;GAC9E,MAAM,IAAIkJ,iBAAiB,CAAC9P,MAAM,KAAK,CAAC,EAAE;IACzCgQ,QAAQ,GAAGjQ,kEAAgC;GAC5C,MAAM;IAAA,IAAAuQ,kBAAA,GACwCR,iBAAiB;IAA7DC,kBAAkB,GAAAO,kBAAA;IAAKR,iBAAiB,GAAAQ,kBAAA,CAAAL,KAAA;IACzCD,QAAQ,GACNjQ,6BAACqN,mBAAmB;MAClBzM,GAAG,EAAEoP,kBAAkB,CAAChH,QAAQ;MAChCpC,WAAW,EAAEoJ,kBAAkB;MAC/B7I,WAAW,EAAEA,WAAW;MACxBN,KAAK,EAAC,MAAM;MACZvG,MAAM,EAAC,MAAM;MACb2G,WAAW,EAAC,UAAU;MACtBG,qBAAqB;MACrBC,YAAY,EAAE,SAAAA;QAAA,OAAMqE,cAAc,CAAC,IAAI,CAAC;;MACxCpE,YAAY,EAAE,SAAAA;QAAA,OAAMoE,cAAc,CAAC,KAAK,CAAC;;MAE5C;;EAGH,OAEE1L;IAAKjB,SAAS,EAAEW,QAAM,CAAC6N;KACrBvN;IAAKjB,SAAS,EAAEW,QAAM,CAACyQ;KAAQF,QAAQ,CAAO,EAC9CjQ;IAAKjB,SAAS,EAAEW,QAAM,CAAC8Q;KACpBT,iBAAiB,CAACrP,GAAG,CAAC,UAACkG,WAAW;IACjC,OACE5G,6BAACqN,mBAAmB;MAClBzM,GAAG,EAAEgG,WAAW,CAACoC,QAAQ;MACzBpC,WAAW,EAAEA,WAAW;MACxB7H,SAAS,EAAEW,QAAM,CAACkH,WAAW;MAC7BG,WAAW,EAAE,CAAC;MACdC,YAAY,EAAE,CAAC;MACfG,WAAW,EAAEA,WAAW;MACxBE,YAAY,EAAE,SAAAA;QAAA,OAAMqE,cAAc,CAAC,IAAI,CAAC;;MACxCpE,YAAY,EAAE,SAAAA;QAAA,OAAMoE,cAAc,CAAC,KAAK,CAAC;;MACzC;GAEL,CAAC,CACE,EACN1L;IAAKjB,SAAS,EAAEW,QAAM,CAAC+N;KACrBzN,6BAACsN,eAAe;IAACvJ,IAAI,EAAEA,IAAI;IAAEC,iBAAiB,EAAE,KAAK;IAAEG,OAAO,EAAEA;IAAW,CACvE,CACF;AAEV,CAAC;;IC3FYsM,SAAS,GAAG,SAAZA,SAASA,CAAIC,UAAsB;EAC9C,IAAMC,QAAQ,GAAGC,6BAAa,CAAC;IAAEC,KAAK,EAAE;GAAsB,CAAC;EAC/D,IAAAC,qBAAA,GAA+BJ,UAAU,CAACxF,SAAS;IAA3CnH,IAAI,GAAA+M,qBAAA,CAAJ/M,IAAI;IAAEwH,YAAY,GAAAuF,qBAAA,CAAZvF,YAAY;EAC1B,IAAMzD,OAAO,GAAGC,gBAAU,CAACxB,cAAc,CAAC;EAE1C,IAAI0C,WAAyB;EAC7B,IAAI0H,QAAQ,EAAE;IACZ1H,WAAW,GAAGjJ,6BAACsQ,WAAW,oBAAKI,UAAU,EAAI;GAC9C,MAAM;IAEL,IAAIjB,WAAmC;IACvClE,YAAY,CAAClD,OAAO,CAAC,UAACiE,CAAC;MACrB,IAAImD,WAAW,EAAE;QACf;;MAEF,IAAMlH,KAAK,GAAG+D,CAAC,CAACoD,QAAQ,CAACC,mBAAK,CAACC,MAAM,CAACC,WAAW,CAAC;MAClD,IAAItH,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEW,YAAY,IAAIX,KAAK,CAACuH,UAAU,EAAE;QAC3CL,WAAW,GAAGlH,KAAK,CAACuH,UAAU;;KAEjC,CAAC;IAEF,IAAIhI,OAAO,CAACrB,WAAW,KAAK,MAAM,IAAIgJ,WAAW,KAAK9K,SAAS,EAAE;MAC/DsE,WAAW,GAAGjJ,6BAACiL,SAAS,oBAAKyF,UAAU,EAAI;KAC5C,MAAM;MACLzH,WAAW,GAAGjJ,6BAACqP,YAAY,oBAAKqB,UAAU,EAAI;;;EAIlD,OACE1Q;IAAKjB,SAAS,EAAEW,MAAM,CAAC6N;KACpBtE,WAAW,EACXyH,UAAU,CAACxF,SAAS,CAAC6F,WAAW,CAACrQ,GAAG,CAAC,UAAC6H,KAAK;IAAA,OAC1CvI,6BAACgR,uBAAa;MAACpQ,GAAG,EAAE2H,KAAK,CAACiE,GAAG;MAAEjE,KAAK,EAAEA,KAAK;MAAEhB,OAAO,EAAE;MAAS;GAChE,CAAC,EAED,CAAAxD,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEkN,gBAAgB,MAAK,KAAK,IAC/BjR;IAAKjB,SAAS,EAAEW,MAAM,CAACwR;KACrBlR;IACEjB,SAAS,EAAEW,MAAM,CAACyR,YAAY;IAC9BtS,OAAO,EAAE,SAAAA;MACPkF,IAAI,CAACqN,UAAU,EAAE;;KAGnBpR,6BAACK,gCAAe;IAACtB,SAAS,EAAEW,MAAM,CAACZ,IAAI;IAAE6P,IAAI,EAAC,IAAI;IAAC7P,IAAI,EAAEuS;IAAgB,oBAElE,CAEZ,CACG;AAEV,CAAC;;ICzCYC,WAAW,GAAG,SAAdA,WAAWA,CAAA5S,IAAA;MACtB6S,GAAG,GAAA7S,IAAA,CAAH6S,GAAG;IACHC,KAAK,GAAA9S,IAAA,CAAL8S,KAAK;IACLC,WAAW,GAAA/S,IAAA,CAAX+S,WAAW;IACXC,cAAc,GAAAhT,IAAA,CAAdgT,cAAc;IACdC,aAAa,GAAAjT,IAAA,CAAbiT,aAAa;IACbxG,mBAAmB,GAAAzM,IAAA,CAAnByM,mBAAmB;IACnBC,eAAe,GAAA1M,IAAA,CAAf0M,eAAe;IACfwG,WAAW,GAAAlT,IAAA,CAAXkT,WAAW;IACXzN,OAAO,GAAAzF,IAAA,CAAPyF,OAAO;EAEP,IAAM+G,SAAS,GAAG2G,iBAAO,CAACJ,WAAW,CAAC;EAEtC/O,eAAS,CAAC;IACR,IAAIwI,SAAS,CAACnH,IAAI,EAAE;MAClBmH,SAAS,CAAC4G,OAAO,CAACP,GAAG,EAAEC,KAAK,EAAEE,cAAc,CAAC,CAACrP,IAAI,CAAC,UAAC0B,IAAI;QACtD,IAAI,CAACA,IAAI,EAAE;UACT;;QAEF,IAAI6N,WAAW,IAAI7N,IAAI,CAACgO,KAAK,KAAKC,6BAAe,CAACC,SAAS,EAAE;UAC3DL,WAAW,CAAC7N,IAAI,CAAC;;OAEpB,CAAC;;IAEJ,OAAO;;MACL,IAAI,EAAAmO,eAAA,GAAAhH,SAAS,CAACnH,IAAI,cAAAmO,eAAA,uBAAdA,eAAA,CAAgBH,KAAK,MAAKC,6BAAe,CAACG,YAAY,EAAE;QAAA,IAAAC,gBAAA;QAC1D,CAAAA,gBAAA,GAAAlH,SAAS,CAACnH,IAAI,cAAAqO,gBAAA,uBAAdA,gBAAA,CAAgB9L,UAAU,EAAE;;KAE/B;GACF,EAAE,CAAC4E,SAAS,CAACnH,IAAI,CAAC,CAAC;EAEpB,IAAMsO,qBAAqB,GAAGV,aAAa,WAAbA,aAAa,GAAIlB,SAAS;EAExD,OAAO4B,qBAAqB,CAAC;IAC3BnH,SAAS,EAATA,SAAS;IACTC,mBAAmB,EAAnBA,mBAAmB;IACnBC,eAAe,EAAfA,eAAe;IACfjH,OAAO,EAAPA;GACD,CAAC;AACJ,CAAC;;;;;;;;;;;;;;;;;;;;"}